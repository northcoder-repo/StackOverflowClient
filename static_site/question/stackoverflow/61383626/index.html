<!doctype html>
<html lang="en">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>How will i display the nested sales array of object for each customer in DataTable?</title>
  <link rel="stylesheet" type="text/css" href="/css/base.css">
  <script type="text/x-mathjax-config">
            MathJax.Hub.Config({"HTML-CSS": { preferredFont: "TeX", availableFonts: ["STIX","TeX"], linebreaks: { automatic:true }, EqnChunk: (MathJax.Hub.Browser.isMobile ? 10 : 50) },
            tex2jax: { inlineMath: [ ["$", "$"], ["\\\\(","\\\\)"] ], displayMath: [ ["$$","$$"], ["\\[", "\\]"] ], processEscapes: true, ignoreClass: "tex2jax_ignore|dno" },
            TeX: {
            extensions: ["begingroup.js"],
            noUndefined: { attributes: { mathcolor: "red", mathbackground: "#FFEEEE", mathsize: "90%" } },
            Macros: { href: "{}" }
            },
            messageStyle: "none",
            styles: { ".MathJax_Display, .MathJax_Preview, .MathJax_Preview > *": { "background": "inherit" } },
            SEEditor: "mathjaxEditing"
            });
        </script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_HTML-full"></script>
 </head>
 <body>
  <div class="question">
   <a href="/questions">All Questions</a>
   <h2>How will i display the nested sales array of object for each customer in DataTable?</h2>
   <div class="container-metadata">
    <div>
     <span>Score: </span> <span>-1</span>
    </div>
    <div>
     <span>Asker: </span> <span>mfa</span>
    </div>
    <div>
     <span>Asked: </span> <span>23 Apr 2020 at 09:19</span>
    </div>
    <div>
     <a href="https://stackoverflow.com/questions/61383626/how-will-i-display-the-nested-sales-array-of-object-for-each-customer-in-datatab">source</a>
    </div>
   </div>
   <div>
    <pre><code>{
  "draw": "1",
  "recordsFiltered": 2,
  "recordsTotal": 2,
  "data": [{
    "_id": "5ea15cad9eceb1681dfba55f",
    "customer_name": "Luke",
    "sales": [{
      "stock_type": "Starter",
      "sales_date": "2020-04-22T18:30:00.000Z",
      "sales_quantity": 10,
      "sales_total_price": 22000
    }, {
      "stock_type": "Finisher",
      "sales_date": "2020-04-22T18:30:00.000Z",
      "sales_quantity": 10,
      "sales_total_price": 23000
    }],
    "id": "5ea15cad9eceb1681dfba55f"
  }, {
    "_id": "5ea15cd69eceb1681dfbb95e",
    "customer_name": "Andy",
    "sales": [{
      "stock_type": "Starter",
      "sales_date": "2020-04-22T18:30:00.000Z",
      "sales_quantity": 10,
      "sales_total_price": 22000
    }],
    "id": "5ea15cd69eceb1681dfbb95e"
  }]
}
</code></pre>
    <p>Output i would like to get is: Luke Starter 2020-04-22T18:30:00.000Z 10 22000 Luke Finisher 2020-04-22T18:30:00.000Z 10 23000 Andy Starter 2020-04-22T18:30:00.000Z 10 22000 'columns': [{ 'data': 'customer_name', 'defaultContent': '-',</p>
    <pre><code>        }, {
            'data': 'sales.sales_quantity',
            'defaultContent': '-',
        }, {
            'data': 'sales.stock_type',
            'defaultContent': '-',

        }, {
            'data': 'sales.sales_date',
            'defaultContent': '-',

        }],
</code></pre>
   </div>
   <div class="tags">
    <span class="tag">datatables</span>
   </div>
   <hr>
   <div class="comment">
    <table>
     <tbody>
      <tr>
       <td></td>
       <td><span>Take a look at the documentation for <a href="https://datatables.net/examples/ajax/" rel="nofollow noreferrer">nested objects</a> . In your case you have objects {...} inside an array [] of "sales" data. You may want to flatten your JSON to make it easier to work with. But that depends on exactly what you are trying to display in the table for each row.</span> <span> - </span> <span class="display-name">andrewJames</span> <span> </span> <span class="date">23 Apr 2020 at 15:47</span></td>
      </tr>
      <tr>
       <td></td>
       <td><span>Can you edit your question to make it clear how you would need the data to be displayed? What is in each row? And what is your current DataTables code? Can you show that also?</span> <span> - </span> <span class="display-name">andrewJames</span> <span> </span> <span class="date">23 Apr 2020 at 15:49</span></td>
      </tr>
      <tr>
       <td></td>
       <td><span>Regarding your edit: Are you saying you want all of that data on one row? Also what is your current DataTables code? Can you add it to the question?</span> <span> - </span> <span class="display-name">andrewJames</span> <span> </span> <span class="date">23 Apr 2020 at 16:13</span></td>
      </tr>
      <tr>
       <td></td>
       <td><span>@andrewjames thnks for the reply.Since from the JSON a provide customer has two sales , I would like to display the sales array in different rows and also the customer name.</span> <span> - </span> <span class="display-name">mfa</span> <span> </span> <span class="date">23 Apr 2020 at 16:15</span></td>
      </tr>
      <tr>
       <td></td>
       <td><span>OK - but you should edit your question to make this clear. And what is your current DataTables code? Can you add it to the question?</span> <span> - </span> <span class="display-name">andrewJames</span> <span> </span> <span class="date">23 Apr 2020 at 16:17</span></td>
      </tr>
      <tr>
       <td></td>
       <td><span>@andrewjames i like to get the sales array in different row along with the same customer name</span> <span> - </span> <span class="display-name">mfa</span> <span> </span> <span class="date">23 Apr 2020 at 16:27</span></td>
      </tr>
     </tbody>
    </table>
   </div>
   <br>
   <div>
    <h2 id="answer_1"><span>Answer 1</span></h2>
    <div class="container-metadata">
     <div>
      <span>Score: </span> <span>0</span>
     </div>
     <div>
      <span>Answerer: </span> <span>andrewJames</span>
     </div>
     <div>
      <span> Answered: </span> <span>23 Apr 2020 at 12:19</span>
     </div>
    </div>
    <div>
     <p>I think what you are trying to do is create a table like this:</p>
     <p><a href="https://i.stack.imgur.com/FO0vn.png" rel="nofollow noreferrer"><img src="/question/stackoverflow/61383626/FO0vn.png" alt="enter image description here"></a></p>
     <p>It is much easier to handle the data if we re-arrange it first, by transforming it to this:</p>
     <pre><code>{
    "draw": "1",
    "recordsFiltered": 2,
    "recordsTotal": 2,
    "data": [{
        "id": "5ea15cad9eceb1681dfba55f",
        "customer_name": "Luke",
        "stock_type": "Starter",
        "sales_date": "2020-04-22T18:30:00.000Z",
        "sales_quantity": 10,
        "sales_total_price": 22000
    }, {
        "id": "5ea15cad9eceb1681dfba55f",
        "customer_name": "Luke",
        "stock_type": "Finisher",
        "sales_date": "2020-04-22T18:30:00.000Z",
        "sales_quantity": 10,
        "sales_total_price": 23000
    }, {
        "id": "5ea15cd69eceb1681dfbb95e",
        "customer_name": "Andy",
        "stock_type": "Starter",
        "sales_date": "2020-04-22T18:30:00.000Z",
        "sales_quantity": 10,
        "sales_total_price": 22000
    }]
}
</code></pre>
     <p>This is what I meant by "flattening" the data. We have removed the nested sub-objects in your original JSON.</p>
     <p>Now, each "data" object maps to one row in the table.</p>
     <p>There are various ways you can do this. One example is as follows:</p>
     <pre><code>function getFlattenedJson() {
  var flatJson = {};
  for (var key in myJson) {
    if (myJson.hasOwnProperty(key) &amp;&amp; key !== "data") {
      flatJson[key] = myJson[key];
    } else {
      flatJson["data"] = [];
      myJson["data"].forEach(function (item, index) {
        var id = item["id"];
        var customer_name = item["customer_name"];
        item["sales"].forEach(function (sale, index) {
          sale["id"] = id;
          sale["customer_name"] = customer_name;
          flatJson["data"].push(sale);
        });
      });
    }
  }
  return flatJson["data"];
}
</code></pre>
     <p>There is no validation in the above code, so it is not suitable for production, by the way.</p>
     <p>Now, when you initialize your DataTable, you can use the above function to pre-process the data.</p>
     <p>An example:</p>
     <pre><code>&lt;body&gt;

&lt;div style="margin: 20px;"&gt;

&lt;table id="example" class="display dataTable cell-border" style="width:100%"&gt;
    &lt;thead&gt; 
        &lt;tr&gt;
            &lt;th&gt;Name&lt;/th&gt;
            &lt;th&gt;Type&lt;/th&gt;
            &lt;th&gt;Date&lt;/th&gt;
            &lt;th&gt;Quantity&lt;/th&gt;
            &lt;th&gt;Price&lt;/th&gt;
        &lt;/tr&gt;
    &lt;/thead&gt;
&lt;/table&gt;

&lt;/div&gt;

&lt;script type="text/javascript"&gt;

  var myJson = {
    "draw": "1",
    "recordsFiltered": 2,
    "recordsTotal": 2,
    "data": [{
        "_id": "5ea15cad9eceb1681dfba55f",
        "customer_name": "Luke",
        "sales": [{
            "stock_type": "Starter",
            "sales_date": "2020-04-22T18:30:00.000Z",
            "sales_quantity": 10,
            "sales_total_price": 22000
        }, {
            "stock_type": "Finisher",
            "sales_date": "2020-04-22T18:30:00.000Z",
            "sales_quantity": 10,
            "sales_total_price": 23000
        }],
        "id": "5ea15cad9eceb1681dfba55f"
    }, {
        "_id": "5ea15cd69eceb1681dfbb95e",
        "customer_name": "Andy",
        "sales": [{
            "stock_type": "Starter",
            "sales_date": "2020-04-22T18:30:00.000Z",
            "sales_quantity": 10,
            "sales_total_price": 22000
        }],
        "id": "5ea15cd69eceb1681dfbb95e"
    }]
};

  // https://stackoverflow.com/questions/61383626/how-will-i-display-the-nested-sales-array-of-object-for-each-customer-in-datatab
  function getFlattenedJson() {
    var flatJson = {};
    for (var key in myJson) {
      if (myJson.hasOwnProperty(key) &amp;&amp; key !== "data") {
        flatJson[key] = myJson[key];
      } else {
        flatJson["data"] = [];
        myJson["data"].forEach(function (item, index) {
          var id = item["id"];
          var customer_name = item["customer_name"];
          item["sales"].forEach(function (sale, index) {
            sale["id"] = id;
            sale["customer_name"] = customer_name;
            flatJson["data"].push(sale);
          });
        });
      }
    }
    return flatJson["data"];
  }

  $(document).ready(function() {
    $('#example').DataTable( {
      "processing": true,
      "data": getFlattenedJson(),
      "columns": [
        { data: "customer_name" },
        { data: "stock_type" },
        { data: "sales_date" },
        { data: "sales_quantity" },
        { data: "sales_total_price" }
      ]
    });
  });
&lt;/script&gt;

&lt;/body&gt;
</code></pre>
     <p>Specifically look at the DataTable initialization line:</p>
     <pre><code>  "data": getFlattenedJson(),
</code></pre>
     <p>One final comment: In my example, I have hard-coded the JSON into the HTML. In your case, you are probably using Ajax with server-side processing.</p>
     <p>Therefore you will need to (a) integrate this into your actual DataTable initialization code. And (b) you will <em>probably</em> need to change the final line of the JavaScript function to this:</p>
     <pre><code>return flatJson;
</code></pre>
     <p>instead of this:</p>
     <pre><code>return flatJson["data"];
</code></pre>
     <p>This is so that the server-side processing variables such as <code>recordsFiltered</code> and <code>recordsTotal</code> are not lost.</p>
    </div>
    <hr>
    <div class="comment">
     <table>
      <tbody>
       <tr>
        <td></td>
        <td><span>the output i like to get is: Luke Starter 2020-04-22T18:30:00.000Z 10 22000 Luke Finisher 2020-04-22T18:30:00.000Z 10 23000 Andy Starter 2020-04-22T18:30:00.000Z. 10 22000</span> <span> - </span> <span class="display-name">mfa</span> <span> </span> <span class="date">23 Apr 2020 at 15:44</span></td>
       </tr>
      </tbody>
     </table>
    </div>
   </div>
   <br>
   <div>
    <span>License: </span> <a href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a> <span>by </span> <a href="https://stackoverflow.com/legal/terms-of-service#licensing">Stack Overflow Inc.</a>
   </div>
  </div>
 </body>
</html>