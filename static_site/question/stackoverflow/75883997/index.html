<!doctype html>
<html lang="en">
 <head>
  <meta charset="UTF-8">
  <title>Issue While Exporting Data table to Excel</title>
  <link rel="stylesheet" type="text/css" href="/css/base.css">
  <script type="text/x-mathjax-config">
            MathJax.Hub.Config({"HTML-CSS": { preferredFont: "TeX", availableFonts: ["STIX","TeX"], linebreaks: { automatic:true }, EqnChunk: (MathJax.Hub.Browser.isMobile ? 10 : 50) },
            tex2jax: { inlineMath: [ ["$", "$"], ["\\\\(","\\\\)"] ], displayMath: [ ["$$","$$"], ["\\[", "\\]"] ], processEscapes: true, ignoreClass: "tex2jax_ignore|dno" },
            TeX: {
            extensions: ["begingroup.js"],
            noUndefined: { attributes: { mathcolor: "red", mathbackground: "#FFEEEE", mathsize: "90%" } },
            Macros: { href: "{}" }
            },
            messageStyle: "none",
            styles: { ".MathJax_Display, .MathJax_Preview, .MathJax_Preview > *": { "background": "inherit" } },
            SEEditor: "mathjaxEditing"
            });
        </script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_HTML-full"></script>
 </head>
 <body>
  <div class="question">
   <a href="/questions">All Questions</a>
   <h2>Issue While Exporting Data table to Excel</h2>
   <div class="container-metadata">
    <div>
     <span>Score: </span> <span>1</span>
    </div>
    <div>
     <span>Asker: </span> <span>Sumeet Kumar</span>
    </div>
    <div>
     <span>Asked: </span> <span>30 Mar 2023 at 03:59</span>
    </div>
    <div>
     <a href="https://stackoverflow.com/questions/75883997/issue-while-exporting-data-table-to-excel">source</a>
    </div>
   </div>
   <div>
    <p>While exporting <code>datatable</code> to excel using <code>table2excel</code> plugin, it's exporting the <code>header</code> row <strong>twice</strong>. Why is it so?</p>
    <p>below is my code:</p>
    <pre><code>&lt;html xmlns="http://www.w3.org/1999/xhtml"&gt;
&lt;head runat="server"&gt;
    &lt;title&gt;&lt;/title&gt;
    &lt;link href="Scripts/assets/dist/css/bootstrap.min.css" rel="stylesheet" /&gt;
    &lt;link href="Scripts/DataTables/DataTables-1.13.3/css/dataTables.bootstrap5.min.css" rel="stylesheet" /&gt;
    &lt;script src="Scripts/assets/dist/js/bootstrap.bundle.min.js"&gt;&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;form id="form1" runat="server"&gt;
        &lt;div id="gridview"&gt;
            &lt;table class="table table-bordered"&gt;
                &lt;thead&gt;
                    &lt;tr&gt;
                        &lt;th&gt;#&lt;/th&gt;
                        &lt;th&gt;First Name&lt;/th&gt;
                        &lt;th&gt;Last Name&lt;/th&gt;
                        &lt;th&gt;State&lt;/th&gt;
                    &lt;/tr&gt;
                &lt;/thead&gt;
                &lt;tbody&gt;
                    &lt;tr&gt;
                        &lt;td&gt;1&lt;/td&gt;
                        &lt;td&gt;First Name of Person 1&lt;/td&gt;
                        &lt;td&gt;Last Name of Person 1&lt;/td&gt;
                        &lt;td&gt;State 1&lt;/td&gt;
                    &lt;/tr&gt;
                    &lt;tr&gt;
                        &lt;td&gt;2&lt;/td&gt;
                        &lt;td&gt;First Name of Person 2&lt;/td&gt;
                        &lt;td&gt;Last Name of Person 2&lt;/td&gt;
                        &lt;td&gt;State 2&lt;/td&gt;
                    &lt;/tr&gt;
                    &lt;tr&gt;
                        &lt;td&gt;3&lt;/td&gt;
                        &lt;td&gt;First Name of Person 3&lt;/td&gt;
                        &lt;td&gt;Last Name of Person 3&lt;/td&gt;
                        &lt;td&gt;State 3&lt;/td&gt;
                    &lt;/tr&gt;
                    &lt;tr&gt;
                        &lt;td&gt;4&lt;/td&gt;
                        &lt;td&gt;First Name of Person 4&lt;/td&gt;
                        &lt;td&gt;Last Name of Person 4&lt;/td&gt;
                        &lt;td&gt;State 4&lt;/td&gt;
                    &lt;/tr&gt;
                    &lt;tr&gt;
                        &lt;td&gt;5&lt;/td&gt;
                        &lt;td&gt;First Name of Person 5&lt;/td&gt;
                        &lt;td&gt;Last Name of Person 5&lt;/td&gt;
                        &lt;td&gt;State 5&lt;/td&gt;
                    &lt;/tr&gt;
                &lt;/tbody&gt;
            &lt;/table&gt;
            &lt;button id="btnExport" class="btn btn-success btn-sm float-end"&gt;&lt;i class="fa fa-file-excel-o"&gt;&lt;/i&gt;&amp;nbsp;Export&lt;/button&gt;
        &lt;/div&gt;

        &lt;script src="Scripts/multiselect/jquery-3.6.0.min.js"&gt;&lt;/script&gt;
        &lt;link href="Scripts/datepicker/jquery-ui.css" rel="stylesheet" /&gt;
        &lt;script src="Scripts/datepicker/jquery-ui.js"&gt;&lt;/script&gt;
        &lt;script src="Scripts/regex.js"&gt;&lt;/script&gt;
        
        &lt;%--&lt;script&gt;
                $.noConflict();
            &lt;/script&gt;--%&gt;
        &lt;%--&lt;script src="Scripts/DataTables/jquery-3.5.1.js"&gt;&lt;/script&gt;--%&gt;
        &lt;script src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js"&gt;&lt;/script&gt;
        &lt;script src="Scripts/DataTables/DataTables-1.13.3/js/dataTables.bootstrap5.min.js"&gt;&lt;/script&gt;
        &lt;script type="text/javascript" src="https://cdn.rawgit.com/rainabba/jquery-table2excel/1.1.0/dist/jquery.table2excel.min.js"&gt;&lt;/script&gt;
        &lt;script&gt;
            $(document).ready(function () {
                var $j = jQuery.noConflict();
                if ($j('#gridview').find("table").length &gt; 0) {
                    $j('#gridview').find("table").DataTable({
                        scrollY: "400px",
                        scrollX: true,
                        scrollCollapse: true,
                        paging: true,
                        fixedColumns: {
                            left: 1
                        },
                        "columnDefs": [{
                            "targets": 'no-sort',
                            "orderable": false,
                        }]
                    });
                }
                $j('#btnExport').click(function (e) {
                    e.preventDefault();
                    $j('#gridview').table2excel({
                        filename: "ExportSummary_" + (new Date).toLocaleTimeString().toString() + ".xls"
                    });
                });
            });
        &lt;/script&gt;
        
    &lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
   </div>
   <div class="tags">
    <span class="tag">jquery</span><span class="tag">datatable</span><span class="tag">export-to-excel</span>
   </div>
   <hr>
   <div class="comment">
    <table>
    </table>
   </div>
   <br>
   <div>
    <h2 id="answer_1"><span>Answer 1</span></h2>
    <div class="container-metadata">
     <div>
      <span>Score: </span> <span>1</span>
     </div>
     <div>
      <span>Answerer: </span> <span>andrewJames</span>
     </div>
     <div>
      <span> Answered: </span> <span>30 Mar 2023 at 10:55</span>
     </div>
    </div>
    <div>
     <p><strong>Quick Answer</strong></p>
     <p>To prevent the duplicated header you need to comment out (or remove) these two settings:</p>
     <pre><code>scrollY: "400px",
scrollX: true,
</code></pre>
     <p>You may also need to comment out (or remove) the <code>fixedColumns</code> setting. Currently, based on the code in your question, the table does not use this setting because the library is missing.</p>
     <hr>
     <p><strong>More Explanation</strong></p>
     <p>Why do you need to avoid the above settings?</p>
     <p>Because DataTables creates a separate HTML table for the header, to support its scrolling and fixed column functionalities:</p>
     <p><a href="https://i.stack.imgur.com/pt8xD.png" rel="nofollow noreferrer"><img src="https://i.stack.imgur.com/pt8xD.png" alt="enter image description here"></a></p>
     <p>It appears as if the table2excel library is not aware of this and just exports what it finds in the DOM.</p>
     <hr>
     <p><strong>Suggestion for a Better Solution</strong></p>
     <p>To avoid this problem, and to have much better control over the Excel export function, you can use DataTables's <a href="https://datatables.net/extensions/buttons/examples/initialisation/simple.html" rel="nofollow noreferrer">built-in support</a> for exporting data to Excel.</p>
     <p>See also: <a href="https://stackoverflow.com/q/75864060/12567365">Export all rows from DataTables in excel but exported only visible rows, but i am try to export all rows that visible or hidden in the pagination</a></p>
    </div>
    <hr>
    <div class="comment">
     <table>
     </table>
    </div>
   </div>
   <br>
   <div>
    <span>License: </span> <a href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a> <span>by </span> <a href="https://stackoverflow.com/legal/terms-of-service#licensing">Stack Overflow Inc.</a>
   </div>
  </div>
 </body>
</html>