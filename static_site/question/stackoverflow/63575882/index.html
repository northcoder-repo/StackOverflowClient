<!doctype html>
<html lang="en">
 <head>
  <meta charset="UTF-8">
  <title>JQuery datatablejs turkish character search problem</title>
  <link rel="stylesheet" type="text/css" href="/css/base.css">
  <script type="text/x-mathjax-config">
            MathJax.Hub.Config({"HTML-CSS": { preferredFont: "TeX", availableFonts: ["STIX","TeX"], linebreaks: { automatic:true }, EqnChunk: (MathJax.Hub.Browser.isMobile ? 10 : 50) },
            tex2jax: { inlineMath: [ ["$", "$"], ["\\\\(","\\\\)"] ], displayMath: [ ["$$","$$"], ["\\[", "\\]"] ], processEscapes: true, ignoreClass: "tex2jax_ignore|dno" },
            TeX: {
            extensions: ["begingroup.js"],
            noUndefined: { attributes: { mathcolor: "red", mathbackground: "#FFEEEE", mathsize: "90%" } },
            Macros: { href: "{}" }
            },
            messageStyle: "none",
            styles: { ".MathJax_Display, .MathJax_Preview, .MathJax_Preview > *": { "background": "inherit" } },
            SEEditor: "mathjaxEditing"
            });
        </script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_HTML-full"></script>
 </head>
 <body>
  <div class="question">
   <a href="/questions">All Questions</a>
   <h2>JQuery datatablejs turkish character search problem</h2>
   <div class="container-metadata">
    <div>
     <span>Score: </span> <span>2</span>
    </div>
    <div>
     <span>Asker: </span> <span>user8599026</span>
    </div>
    <div>
     <span>Asked: </span> <span>25 Aug 2020 at 09:28</span>
    </div>
    <div>
     <a href="https://stackoverflow.com/questions/63575882/jquery-datatablejs-turkish-character-search-problem">source</a>
    </div>
   </div>
   <div>
    <p>I have a jquery datatablejs. I list items. I want to search something in search. But when i enter İ it finds only İ chars. <strong>I want to find also i chars.</strong> Like I-ı Ü-ü.</p>
    <p>I searched lots of sites/docs but find anything.</p>
    <p>This link below defines turkish chars for sorting. Can we use this for searching? <strong>Other problem is or we can say my constraint is I can't change datatable's original data. I can't replace İ to i or i to İ.</strong></p>
    <p><a href="https://datatables.net/plug-ins/sorting/turkish-string" rel="nofollow noreferrer">https://datatables.net/plug-ins/sorting/turkish-string</a></p>
    <p>Note: I am getting data with ajax from mvc controller. I do not get json data. I get model object.</p>
   </div>
   <div class="tags">
    <span class="tag">javascript</span><span class="tag">html</span><span class="tag">jquery</span><span class="tag">model-view-controller</span><span class="tag">datatables</span>
   </div>
   <hr>
   <div class="comment">
    <table>
    </table>
   </div>
   <br>
   <div>
    <h2 id="answer_1"><span>Answer 1</span> <span class="arrow"> <a href="#answer_2">↓</a> </span></h2>
    <div class="container-metadata">
     <div>
      <span>Score: </span> <span>1</span>
     </div>
     <div>
      <span>Answerer: </span> <span>studen</span>
     </div>
     <div>
      <span> Answered: </span> <span>25 Aug 2020 at 11:23</span>
     </div>
    </div>
    <div>
     <p>Change Encoding of the file to UTF-8 and retype characters and save. test it.<br>
       [ { "Numara": "şükrü yağcı", "Ad": "5505" }, { "Numara": "şamil öndüş", "Ad": "6655" }, {</p>
    </div>
    <hr>
    <div class="comment">
     <table>
      <tbody>
       <tr>
        <td></td>
        <td><span>open with notepad++, do menu encoding utf8 on json file also.</span> <span> - </span> <span class="display-name">studen</span> <span> </span> <span class="date">25 Aug 2020 at 11:58</span></td>
       </tr>
       <tr>
        <td></td>
        <td><span><code>contentType: "application/json; charset=utf-8",</code> .. I insert this code to ajax get. I did not worked.</span> <span> - </span> <span class="display-name">user8599026</span> <span> </span> <span class="date">25 Aug 2020 at 12:56</span></td>
       </tr>
       <tr>
        <td></td>
        <td><span><code>$.ajax({ "url": "URLTOGO", "method": "GET", contentType: "application/json; charset=utf-8", ....}); </code></span> <span> - </span> <span class="display-name">user8599026</span> <span> </span> <span class="date">25 Aug 2020 at 12:57</span></td>
       </tr>
       <tr>
        <td></td>
        <td><span>The problem is my data is not json. It is an object.</span> <span> - </span> <span class="display-name">user8599026</span> <span> </span> <span class="date">25 Aug 2020 at 12:58</span></td>
       </tr>
      </tbody>
     </table>
    </div>
   </div>
   <div>
    <h2 id="answer_2"><span>Answer 2</span> <span class="arrow"> <a href="#answer_1">↑</a> </span> <span class="arrow"> <a href="#answer_3">↓</a> </span></h2>
    <div class="container-metadata">
     <div>
      <span>Score: </span> <span>1</span>
     </div>
     <div>
      <span>Answerer: </span> <span>andrewJames</span>
     </div>
     <div>
      <span> Answered: </span> <span>25 Aug 2020 at 16:01</span>
     </div>
    </div>
    <div>
     <p>You can use the following plug-in provided by DataTables:</p>
     <p><a href="https://datatables.net/plug-ins/filtering/type-based/diacritics-neutralise" rel="nofollow noreferrer">Diacritics Neutralize</a></p>
     <p>This can be included in your HTML page as follows:</p>
     <pre><code>https://cdn.datatables.net/plug-ins/1.10.21/filtering/type-based/diacritics-neutralise.js
</code></pre>
     <p>However, to use this plug-in effectively for your requirement, there are some extra steps needed, so that the data changes are effectively invisible to the user.</p>
     <p><strong>Overview</strong></p>
     <ol>
      <li>
       <p>Add a hidden, but searchable, extra column to your data table. This column will contain "normalized" versions (explained below) of all of the text from the other columns in the table. You only need to store a word in this column if its normalized form is different from the original un-normalized form.</p></li>
      <li>
       <p>Add a customized search function which performs the same normalization process on search terms entered by the user.</p></li>
     </ol>
     <p>This means that any search for <code>i</code> or <code>I</code> or <code>İ</code> can be made by a user - and it will successfully find any rows containing any one of these characters.</p>
     <p>The key part here is that we apply the exact same normalization process to the table data and to the search data.</p>
     <p><strong>Handling the Table Data</strong></p>
     <p>If you have full control over the data to be displayed in the table, you can perform step (1) before you send the data to the data table. You just need to define the column as hidden:</p>
     <pre><code>"columnDefs": [
  {
    "targets": [ -1 ], // -1 refers to the final column in the table
    "visible": false,
    "searchable": true
  }
]
</code></pre>
     <p>This requires you to have the equivalent server-side function as the one provided by the "diacritics-neutralize" function we will be using. If that is not an option, you may prefer to use a function to process the data in the table itself:</p>
     <pre><code>"columnDefs": [
  {
    "targets": [ -1 ], // -1 refers to the final column in the table
    "visible": false,
    "searchable": true,
    "data": function ( row, type, val, meta ) {
      return normalizeTableData( row ); // see below!
    }
  }
]
</code></pre>
     <p><strong>Handling the Search Term</strong></p>
     <p>To normalize the search term, we can use the following DataTables search function:</p>
     <pre><code>$('#example_filter input').off().keyup(function () {
  var normString = normalizeString( this.value ); // see below!
  table.search(normString).draw();
});
</code></pre>
     <p>This assumes our HTML table has an ID of "example".</p>
     <p><strong>Performing the Normalization</strong></p>
     <p>The function is used as follows:</p>
     <pre><code>var normString = jQuery.fn.DataTable.ext.type.search.string(inputString);
</code></pre>
     <p>If you take a look at the JavaScript for this function, you will see it contains many mappings - for example:</p>
     <pre><code>{'base':'I', 'letters':/[\u0049\u24BE\uFF29\u00CC\u00CD\u00CE\u0128\u012A\u012C\u0130\u00CF\u1E2E\u1EC8\u01CF\u0208\u020A\u1ECA\u012E\u1E2C\u0197]/g}
</code></pre>
     <p>The Turkish capital letter for <code>I</code> is <code>İ</code>, which has a Unicode value of <a href="https://www.fileformat.info/info/unicode/char/0130/index.htm" rel="nofollow noreferrer">u0130</a>. You can see this is listed as one of the characters which is mapped to <code>I</code> in the provided mapping.</p>
     <p>So, our <code>normalizeString</code> function is simply:</p>
     <pre><code>function normalizeString(inputString) {
  return jQuery.fn.DataTable.ext.type.search.string(inputString);
}
</code></pre>
     <p>For the table data, the processing depends on whether data is provided as objects <code>{...}</code> or arrays <code>[...]</code>. I will assume arrays - but the iteration will be different for objects, of course:</p>
     <pre><code>function normalizeTableData( row ) {
    var normalizedData = '';
    row.forEach(function (item) {
      var new = normalizeString( item );
      if ( new !== item ) {
        normalizedData = normalizedData + ' ' + new;
      }
    });
    return normalizedData;
}
</code></pre>
     <p>You may need to enhance the above iteration, depending on the types of data in your table (e.g. numeric data values, which cannot be normalized).</p>
    </div>
    <hr>
    <div class="comment">
     <table>
      <tbody>
       <tr>
        <td></td>
        <td><span>i liked your solution. I will test it.</span> <span> - </span> <span class="display-name">user8599026</span> <span> </span> <span class="date">26 Aug 2020 at 07:52</span></td>
       </tr>
      </tbody>
     </table>
    </div>
   </div>
   <div>
    <h2 id="answer_3"><span>Answer 3</span> <span class="arrow"> <a href="#answer_2">↑</a> </span> <span class="arrow"> <a href="#answer_4">↓</a> </span></h2>
    <div class="container-metadata">
     <div>
      <span>Score: </span> <span>1</span>
     </div>
     <div>
      <span>Answerer: </span> <span>user8599026</span>
     </div>
     <div>
      <span> Answered: </span> <span>26 Aug 2020 at 11:48</span>
     </div>
    </div>
    <div>
     <p>I found a solution and it work without any problem.</p>
     <p>Here is the solution:</p>
     <p>I call this function:</p>
     <p><a href="https://jsfiddle.net/s39o8pdu/1/" rel="nofollow noreferrer">https://jsfiddle.net/s39o8pdu/1/</a></p>
     <pre><code>jQuery.extend( jQuery.fn.dataTableExt.oSort, {
  'locale-compare-asc': function ( a, b ) {
     return a.localeCompare(b, 'cs', { sensitivity: 'case' })
  },
  'locale-compare-desc': function ( a, b ) {
     return b.localeCompare(a, 'cs', { sensitivity: 'case' })
  }
})

jQuery.fn.dataTable.ext.type.search['locale-compare'] = function (data) {
    return NeutralizeAccent(data);
}

function NeutralizeAccent(data)
{
  return !data
      ? ''
        : typeof data === 'string'
        ? data
        .replace(/\n/g, ' ')
        .replace(/[éÉěĚèêëÈÊË]/g, 'e')
        .replace(/[šŠ]/g, 's')
        .replace(/[čČçÇ]/g, 'c')
        .replace(/[řŘ]/g, 'r')
        .replace(/[žŽ]/g, 'z')
        .replace(/[ýÝ]/g, 'y')
        .replace(/[áÁâàÂÀ]/g, 'a')
        .replace(/[íÍîïÎİÏ]/g, 'i')
        .replace(/[ťŤ]/g, 't')
        .replace(/[ďĎ]/g, 'd')
        .replace(/[ňŇ]/g, 'n')
        .replace(/[óÓ]/g, 'o')
        .replace(/[úÚůŮ]/g, 'u')
        : data
}

var table = $('#example').DataTable({
    columnDefs : [
     { targets: 0, type: 'locale-compare' },
  ]
})

 $('#example_filter input').keyup(function () {
    table
    .search(
      jQuery.fn.dataTable.ext.type.search.string(NeutralizeAccent(this.value))
    )
    .draw()
 })
 
</code></pre>
     <p>So good luck who has this problem. If you have any problem ask me. I know how to solve this problem now.</p>
     <p>Like andrewjames said on the answers we solve this problem with Accent neutralise.</p>
    </div>
    <hr>
    <div class="comment">
     <table>
     </table>
    </div>
   </div>
   <div>
    <h2 id="answer_4"><span>Answer 4</span> <span class="arrow"> <a href="#answer_3">↑</a> </span></h2>
    <div class="container-metadata">
     <div>
      <span>Score: </span> <span>0</span>
     </div>
     <div>
      <span>Answerer: </span> <span>EmirhanErturk</span>
     </div>
     <div>
      <span> Answered: </span> <span>25 Aug 2020 at 12:03</span>
     </div>
    </div>
    <div>
     <p>you can try this code to replace</p>
     <pre><code>   $("input[type='search']").keyup(function () {
            var charMap = {
                Ç: 'C',
                Ö: 'O',
                Ş: 'S',
                İ: 'I',
                I: 'i',
                Ü: 'U',
                Ğ: 'G',
                ç: 'c',
                ö: 'o',
                ş: 's',
                ı: 'i',
                ü: 'u',
                ğ: 'g'
            };

            var str = $("input[type='search']").val();
            str_array = str.split('');

            for (var i = 0, len = str_array.length; i &lt; len; i++) {
                str_array[i] = charMap[str_array[i]] || str_array[i];
            }

            str = str_array.join('');

            var clearStr = str.replace(" ", "").replace("-", "").replace(/[^a-z0-9-.çöşüğı]/gi, "");


            $("input[type='search']").val(clearStr);

        });
</code></pre>
    </div>
    <hr>
    <div class="comment">
     <table>
      <tbody>
       <tr>
        <td></td>
        <td><span>but if i do not want to replace values. Because they are unique. I cannot change data on the datatable. Anyway i will do it. For testing.</span> <span> - </span> <span class="display-name">user8599026</span> <span> </span> <span class="date">25 Aug 2020 at 12:06</span></td>
       </tr>
       <tr>
        <td></td>
        <td><span>Op stated he can't change data or replace values.</span> <span> - </span> <span class="display-name">Bram</span> <span> </span> <span class="date">25 Aug 2020 at 13:13</span></td>
       </tr>
      </tbody>
     </table>
    </div>
   </div>
   <br>
   <div>
    <span>License: </span> <a href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a> <span>by </span> <a href="https://stackoverflow.com/legal/terms-of-service#licensing">Stack Overflow Inc.</a>
   </div>
  </div>
 </body>
</html>