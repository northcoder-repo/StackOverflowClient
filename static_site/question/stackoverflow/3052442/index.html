<!doctype html>
<html lang="en">
 <head>
  <meta charset="UTF-8">
  <title>What is the difference between "text" and new String("text")?</title>
  <link rel="stylesheet" type="text/css" href="/css/base.css">
  <script type="text/x-mathjax-config">
            MathJax.Hub.Config({"HTML-CSS": { preferredFont: "TeX", availableFonts: ["STIX","TeX"], linebreaks: { automatic:true }, EqnChunk: (MathJax.Hub.Browser.isMobile ? 10 : 50) },
            tex2jax: { inlineMath: [ ["$", "$"], ["\\\\(","\\\\)"] ], displayMath: [ ["$$","$$"], ["\\[", "\\]"] ], processEscapes: true, ignoreClass: "tex2jax_ignore|dno" },
            TeX: {
            extensions: ["begingroup.js"],
            noUndefined: { attributes: { mathcolor: "red", mathbackground: "#FFEEEE", mathsize: "90%" } },
            Macros: { href: "{}" }
            },
            messageStyle: "none",
            styles: { ".MathJax_Display, .MathJax_Preview, .MathJax_Preview > *": { "background": "inherit" } },
            SEEditor: "mathjaxEditing"
            });
        </script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_HTML-full"></script>
 </head>
 <body>
  <div class="question">
   <a href="/questions">All Questions</a>
   <h2>What is the difference between "text" and new String("text")?</h2>
   <div class="container-metadata">
    <div>
     <span>Score: </span> <span>237</span>
    </div>
    <div>
     <span>Asker: </span> <span>user368141</span>
    </div>
    <div>
     <span>Asked: </span> <span>16 Jun 2010 at 10:29</span>
    </div>
    <div>
     <a href="https://stackoverflow.com/questions/3052442/what-is-the-difference-between-text-and-new-stringtext">source</a>
    </div>
   </div>
   <div>
    <p>What is the difference between these two following statements?</p>
    <pre><code>String s = "text";

String s = new String("text");
</code></pre>
   </div>
   <div class="tags">
    <span class="tag">java</span><span class="tag">string</span>
   </div>
   <hr>
   <div class="comment">
    <table>
     <tbody>
      <tr>
       <td></td>
       <td><span>Related topic: <a href="http://openjdk.java.net/jeps/192" rel="nofollow noreferrer"><i>JEP 192: String Deduplication in G1</i></a>.</span> <span> - </span> <span class="display-name">Basil Bourque</span> <span> </span> <span class="date">7 Jun 2018 at 22:49</span></td>
      </tr>
      <tr>
       <td></td>
       <td><span>Anyone please reply to this. String a = "Java"; String b = "Java"; System.out.println(a == b); true // but System.out.println("a==b?"+a == b); //false...</span> <span> - </span> <span class="display-name">Energy</span> <span> </span> <span class="date">4 Mar 2020 at 07:25</span></td>
      </tr>
      <tr>
       <td></td>
       <td><span>i don't understand when i added some comment ("a==b ?) =&gt; my result becomes FALSE. why?</span> <span> - </span> <span class="display-name">Energy</span> <span> </span> <span class="date">4 Mar 2020 at 07:26</span></td>
      </tr>
      <tr>
       <td></td>
       <td><span>@Energy The result is <code>false</code> because order of operations dictates that the + operator goes first, concatenating "a==b ?" with a to create a String "a==b?Java". Then the expression <code>"a==b?Java" == b</code> evaluates to false.</span> <span> - </span> <span class="display-name">Allison B</span> <span> </span> <span class="date">11 Mar 2020 at 18:12</span></td>
      </tr>
      <tr>
       <td></td>
       <td><span>@AllisonB got it, thank you so much!</span> <span> - </span> <span class="display-name">Energy</span> <span> </span> <span class="date">14 Mar 2020 at 04:46</span></td>
      </tr>
     </tbody>
    </table>
   </div>
   <br>
   <div>
    <h2 id="answer_1"><span>Answer 1</span> <span class="arrow"> <a href="#answer_2">↓</a> </span></h2>
    <div class="container-metadata">
     <div>
      <span>Score: </span> <span>229</span>
     </div>
     <div>
      <span>Answerer: </span> <span>polygenelubricants</span>
     </div>
     <div>
      <span> Answered: </span> <span>16 Jun 2010 at 10:30</span>
     </div>
    </div>
    <div>
     <p><code>new String("text");</code> explicitly creates a new and referentially distinct instance of a <code>String</code> object; <code>String s = "text";</code> may reuse an instance from the <strong>string constant pool</strong> if one is available.</p>
     <p>You <em>very rarely</em> would ever want to use the <code>new String(anotherString)</code> constructor. From the API:</p>
     <blockquote>
      <p><a href="http://java.sun.com/javase/6/docs/api/java/lang/String.html#String%28java.lang.String%29" rel="noreferrer"><code>String(String original)</code></a> : Initializes a <em>newly created</em> <code>String</code> object so that it represents the same sequence of characters as the argument; in other words, the newly created string is a copy of the argument string. Unless an explicit copy of original is needed, use of this constructor is unnecessary since strings are immutable.</p>
     </blockquote>
     <h3>Related questions</h3>
     <ul>
      <li><a href="https://stackoverflow.com/questions/334518/java-strings-string-s-new-stringsilly"> Java Strings: “String s = new String(”silly“);” </a></li>
      <li><a href="https://stackoverflow.com/questions/2009228/strings-are-objects-in-java-so-why-dont-we-use-new-to-create-them"> Strings are objects in Java, so why don’t we use ‘new’ to create them? </a></li>
     </ul>
     <hr>
     <h3>What referential distinction means</h3>
     <p>Examine the following snippet:</p>
     <pre><code>    String s1 = "foobar";
    String s2 = "foobar";

    System.out.println(s1 == s2);      // true

    s2 = new String("foobar");
    System.out.println(s1 == s2);      // false
    System.out.println(s1.equals(s2)); // true
</code></pre>
     <p><code>==</code> on two reference types is a reference identity comparison. Two objects that are <code>equals</code> are not necessarily <code>==</code>. It is usually wrong to use <code>==</code> on reference types; most of the time <code>equals</code> need to be used instead.</p>
     <p>Nonetheless, if for whatever reason you need to create two <code>equals</code> but not <code>==</code> string, you <em>can</em> use the <code>new String(anotherString)</code> constructor. It needs to be said again, however, that this is <em>very</em> peculiar, and is rarely the intention.</p>
     <h3>References</h3>
     <ul>
      <li><a href="http://java.sun.com/docs/books/jls/third_edition/html/expressions.html#15.21.3" rel="noreferrer">JLS 15.21.3 Reference Equality Operators == and !=</a></li>
      <li><a href="http://java.sun.com/javase/6/docs/api/java/lang/Object.html#equals%28java.lang.Object%29" rel="noreferrer"><code>class Object</code> - <code>boolean Object(equals)</code></a></li>
     </ul>
     <h3>Related issues</h3>
     <ul>
      <li><a href="https://stackoverflow.com/questions/767372/java-string-equals-versus"> Java String.equals versus == </a></li>
      <li><a href="https://stackoverflow.com/questions/513832/how-do-i-compare-strings-in-java">How do I compare strings in Java?</a></li>
     </ul>
    </div>
    <hr>
    <div class="comment">
     <table>
      <tbody>
       <tr>
        <td>3</td>
        <td><span>If i write: String s = new String("abc"); And now i write: String s = "abc"; Will String s = "abc"; create a new String literal in the String pool?</span> <span> - </span> <span class="display-name">Kaveesh Kanwal</span> <span> </span> <span class="date">16 Apr 2015 at 18:34</span></td>
       </tr>
       <tr>
        <td></td>
        <td><span>Why nobody answer preceding question?</span> <span> - </span> <span class="display-name">zeds</span> <span> </span> <span class="date">1 Dec 2015 at 05:56</span></td>
       </tr>
       <tr>
        <td>2</td>
        <td><span>@KaveeshKanwal No, the literal won't be duplicated. As you can see there are 2 <code>"abc"</code>s. Only one of them will go to the String pool, and the other one will refer to it. Then there's the <code>s</code> which will be proper new object.</span> <span> - </span> <span class="display-name">Kayaman</span> <span> </span> <span class="date">16 Mar 2016 at 11:21</span></td>
       </tr>
       <tr>
        <td>1</td>
        <td><span>@Kaveesh Kanwal - String s = new String("abc") will only create a new String object with value "abc". And the 2nd statement will check if there is any "abc" string literal is already present in String Pool or not. If already present then reference to the existing one is returned and if not then new literal ("abc") is created in String pool. Hope it resolves your query !!</span> <span> - </span> <span class="display-name">user968813</span> <span> </span> <span class="date">3 May 2016 at 07:38</span></td>
       </tr>
       <tr>
        <td></td>
        <td><span>There is no 'may' about it. The compiler <i>must</i> pool string literals. <a href="https://docs.oracle.com/javase/specs/jls/se10/html/jls-3.html#jls-3.10.5" rel="nofollow noreferrer">JLS 3.10.5</a>.</span> <span> - </span> <span class="display-name">user207421</span> <span> </span> <span class="date">24 Apr 2018 at 11:45</span></td>
       </tr>
       <tr>
        <td></td>
        <td><span>new String() is useful when you want to take a substring but not keep around a reference to the original (which people say the substring() method does).</span> <span> - </span> <span class="display-name">Kitten</span> <span> </span> <span class="date">15 Jan 2019 at 14:35</span></td>
       </tr>
      </tbody>
     </table>
    </div>
   </div>
   <div>
    <h2 id="answer_2"><span>Answer 2</span> <span class="arrow"> <a href="#answer_1">↑</a> </span> <span class="arrow"> <a href="#answer_3">↓</a> </span></h2>
    <div class="container-metadata">
     <div>
      <span>Score: </span> <span>147</span>
     </div>
     <div>
      <span>Answerer: </span> <span>Braj</span>
     </div>
     <div>
      <span> Answered: </span> <span>8 May 2014 at 15:26</span>
     </div>
    </div>
    <div>
     <p>String <a href="https://docs.oracle.com/javase/tutorial/java/nutsandbolts/datatypes.html" rel="noreferrer">literals</a> will go into <strong>String Constant Pool</strong>.</p>
     <p>The below snapshot might help you to understand it <em>visually</em> to remember it for longer time.</p>
     <p><img src="https://i.stack.imgur.com/71l1O.jpg" alt="enter image description here"></p>
     <hr>
     <p>Object creation line by line:</p>
     <pre><code>String str1 = new String("java5");
</code></pre>
     <p>Using string literal "java5" in the constructor, a new string value is stored in string constant pool. Using new operator, a new string object is created in the heap with "java5" as value.</p>
     <pre><code>String str2 = "java5"
</code></pre>
     <p>Reference "str2" is pointed to already stored value in string constant pool</p>
     <pre><code>String str3 = new String(str2);
</code></pre>
     <p>A new string object is created in the heap with the same value as reference by "str2"</p>
     <pre><code>String str4 = "java5";
</code></pre>
     <p>Reference "str4" is pointed to already stored value in string constant pool</p>
     <p>Total objects : Heap - 2, Pool - 1</p>
     <p><a href="https://community.oracle.com/thread/1758056?tstart=0" rel="noreferrer">Further reading on Oracle community</a></p>
    </div>
    <hr>
    <div class="comment">
     <table>
      <tbody>
       <tr>
        <td>1</td>
        <td><span>Good answer.. but weant to know that now i am giong to change value of str1="java6" then it will change value of str4?</span> <span> - </span> <span class="display-name">CoronaPintu</span> <span> </span> <span class="date">12 May 2014 at 08:25</span></td>
       </tr>
       <tr>
        <td>3</td>
        <td><span>yes i had check it will not change the value of str4</span> <span> - </span> <span class="display-name">CoronaPintu</span> <span> </span> <span class="date">12 May 2014 at 08:33</span></td>
       </tr>
       <tr>
        <td></td>
        <td><span>@Braj Can you provide documentation of your Answer’s assertion?</span> <span> - </span> <span class="display-name">Basil Bourque</span> <span> </span> <span class="date">1 Jul 2015 at 16:47</span></td>
       </tr>
       <tr>
        <td></td>
        <td><span>@Braj: Are the headers for the 'Heap' &amp; 'pool' in the table supposed to be reverse ?</span> <span> - </span> <span class="display-name">Rahul Kurup</span> <span> </span> <span class="date">8 Aug 2015 at 10:52</span></td>
       </tr>
       <tr>
        <td>1</td>
        <td><span>Not correct. The constant pool is created at compile time, not at execution time. Don't use quote formatting for text that isn't quoted.</span> <span> - </span> <span class="display-name">user207421</span> <span> </span> <span class="date">7 Feb 2016 at 09:31</span></td>
       </tr>
       <tr>
        <td></td>
        <td><span>@EJP Can you please elaborate with finer details? Constant pool is residing in memory right and hence I am able to visualise it being created and modified at runtime only. In the above example, what will go wrong considering the fact that pool is created at compile time?</span> <span> - </span> <span class="display-name">user104309</span> <span> </span> <span class="date">26 Mar 2017 at 08:37</span></td>
       </tr>
       <tr>
        <td></td>
        <td><span>At compile time,string literals in the class are accumulated (the action of pooling) (only one occurrence of that literal will be available even if it appears many times) in one place in bytecode (in stringpool section) so that on "class load" these pooled strings are actually created in memory (might be inside a section of the heap) ... While the actual execution of the bytecode instructions it will refer (load from this pool) to this pool in memory. <code>javap -verbose</code> will give you an idea.</span> <span> - </span> <span class="display-name">user104309</span> <span> </span> <span class="date">26 Mar 2017 at 09:44</span></td>
       </tr>
      </tbody>
     </table>
    </div>
   </div>
   <div>
    <h2 id="answer_3"><span>Answer 3</span> <span class="arrow"> <a href="#answer_2">↑</a> </span> <span class="arrow"> <a href="#answer_4">↓</a> </span></h2>
    <div class="container-metadata">
     <div>
      <span>Score: </span> <span>16</span>
     </div>
     <div>
      <span>Answerer: </span> <span>user159088</span>
     </div>
     <div>
      <span> Answered: </span> <span>16 Jun 2010 at 10:32</span>
     </div>
    </div>
    <div>
     <p>One creates a String in the <a href="http://www.xyzws.com/Javafaq/what-is-string-literal-pool/3" rel="noreferrer">String Constant Pool</a></p>
     <pre><code>String s = "text";
</code></pre>
     <p>the other one creates a string in the constant pool (<code>"text"</code>) and another string in normal heap space (<code>s</code>). Both strings will have the same value, that of "text".</p>
     <pre><code>String s = new String("text");
</code></pre>
     <p><code>s</code> is then lost (eligible for GC) if later unused.</p>
     <p>String literals on the other hand are reused. If you use <code>"text"</code> in multiple places of your class it will in fact be one and only one String (i.e. multiple references to the same string in the pool).</p>
    </div>
    <hr>
    <div class="comment">
     <table>
      <tbody>
       <tr>
        <td></td>
        <td><span>Strings in the constant pool are never lost. Did you mean to say 's' is lost if later unused?</span> <span> - </span> <span class="display-name">user207421</span> <span> </span> <span class="date">16 Jun 2010 at 10:38</span></td>
       </tr>
       <tr>
        <td></td>
        <td><span>@EJP: yes, I did mean "s". Thanks for noticing. I will correct the question.</span> <span> - </span> <span class="display-name">user159088</span> <span> </span> <span class="date">16 Jun 2010 at 10:43</span></td>
       </tr>
      </tbody>
     </table>
    </div>
   </div>
   <div>
    <h2 id="answer_4"><span>Answer 4</span> <span class="arrow"> <a href="#answer_3">↑</a> </span> <span class="arrow"> <a href="#answer_5">↓</a> </span></h2>
    <div class="container-metadata">
     <div>
      <span>Score: </span> <span>10</span>
     </div>
     <div>
      <span>Answerer: </span> <span>Ciro Santilli OurBigBook.com</span>
     </div>
     <div>
      <span> Answered: </span> <span>15 Apr 2017 at 07:18</span>
     </div>
    </div>
    <div>
     <h2>JLS</h2>
     <p>The concept is called "interning" by the JLS.</p>
     <p>Relevant passage from <a href="http://docs.oracle.com/javase/specs/jls/se7/html/jls-3.html#jls-3.10.5" rel="noreferrer">JLS 7 3.10.5</a>:</p>
     <blockquote>
      <p>Moreover, a string literal always refers to the same instance of class String. This is because string literals - or, more generally, strings that are the values of constant expressions (§15.28) - are "interned" so as to share unique instances, using the method String.intern.</p>
      <p><strong>Example 3.10.5-1. String Literals</strong></p>
      <p>The program consisting of the compilation unit (§7.3):</p>
      <pre><code>package testPackage;
class Test {
    public static void main(String[] args) {
        String hello = "Hello", lo = "lo";
        System.out.print((hello == "Hello") + " ");
        System.out.print((Other.hello == hello) + " ");
        System.out.print((other.Other.hello == hello) + " ");
        System.out.print((hello == ("Hel"+"lo")) + " ");
        System.out.print((hello == ("Hel"+lo)) + " ");
        System.out.println(hello == ("Hel"+lo).intern());
    }
}
class Other { static String hello = "Hello"; }
</code></pre>
      <p>and the compilation unit:</p>
      <pre><code>package other;
public class Other { public static String hello = "Hello"; }
</code></pre>
      <p>produces the output:</p>
      <pre><code>true true true true false true
</code></pre>
     </blockquote>
     <h2>JVMS</h2>
     <p><a href="https://docs.oracle.com/javase/specs/jvms/se7/html/jvms-5.html#jvms-5.1" rel="noreferrer">JVMS 7 5.1 says</a>:</p>
     <blockquote>
      <p>A string literal is a reference to an instance of class String, and is derived from a CONSTANT_String_info structure (§4.4.3) in the binary representation of a class or interface. The CONSTANT_String_info structure gives the sequence of Unicode code points constituting the string literal.</p>
      <p>The Java programming language requires that identical string literals (that is, literals that contain the same sequence of code points) must refer to the same instance of class String (JLS §3.10.5). In addition, if the method String.intern is called on any string, the result is a reference to the same class instance that would be returned if that string appeared as a literal. Thus, the following expression must have the value true:</p>
      <pre><code>("a" + "b" + "c").intern() == "abc"
</code></pre>
      <p>To derive a string literal, the Java Virtual Machine examines the sequence of code points given by the CONSTANT_String_info structure.</p>
      <ul>
       <li>
        <p>If the method String.intern has previously been called on an instance of class String containing a sequence of Unicode code points identical to that given by the CONSTANT_String_info structure, then the result of string literal derivation is a reference to that same instance of class String.</p></li>
       <li>
        <p>Otherwise, a new instance of class String is created containing the sequence of Unicode code points given by the CONSTANT_String_info structure; a reference to that class instance is the result of string literal derivation. Finally, the intern method of the new String instance is invoked.</p></li>
      </ul>
     </blockquote>
     <h2>Bytecode</h2>
     <p>It is also instructive to look at the bytecode implementation on OpenJDK 7.</p>
     <p>If we decompile:</p>
     <pre><code>public class StringPool {
    public static void main(String[] args) {
        String a = "abc";
        String b = "abc";
        String c = new String("abc");
        System.out.println(a);
        System.out.println(b);
        System.out.println(a == c);
    }
}
</code></pre>
     <p>we have on the constant pool:</p>
     <pre><code>#2 = String             #32   // abc
[...]
#32 = Utf8               abc
</code></pre>
     <p>and <code>main</code>:</p>
     <pre><code> 0: ldc           #2          // String abc
 2: astore_1
 3: ldc           #2          // String abc
 5: astore_2
 6: new           #3          // class java/lang/String
 9: dup
10: ldc           #2          // String abc
12: invokespecial #4          // Method java/lang/String."&lt;init&gt;":(Ljava/lang/String;)V
15: astore_3
16: getstatic     #5          // Field java/lang/System.out:Ljava/io/PrintStream;
19: aload_1
20: invokevirtual #6          // Method java/io/PrintStream.println:(Ljava/lang/String;)V
23: getstatic     #5          // Field java/lang/System.out:Ljava/io/PrintStream;
26: aload_2
27: invokevirtual #6          // Method java/io/PrintStream.println:(Ljava/lang/String;)V
30: getstatic     #5          // Field java/lang/System.out:Ljava/io/PrintStream;
33: aload_1
34: aload_3
35: if_acmpne     42
38: iconst_1
39: goto          43
42: iconst_0
43: invokevirtual #7          // Method java/io/PrintStream.println:(Z)V
</code></pre>
     <p>Note how:</p>
     <ul>
      <li><code>0</code> and <code>3</code>: the same <code>ldc #2</code> constant is loaded (the literals)</li>
      <li><code>12</code>: a new string instance is created (with <code>#2</code> as argument)</li>
      <li><code>35</code>: <code>a</code> and <code>c</code> are compared as regular objects with <code>if_acmpne</code></li>
     </ul>
     <p>The representation of constant strings is quite magic on the bytecode:</p>
     <ul>
      <li>it has a dedicated <a href="https://docs.oracle.com/javase/specs/jvms/se7/html/jvms-4.html#jvms-4.4.3" rel="noreferrer">CONSTANT_String_info</a> structure, unlike regular objects (e.g. <code>new String</code>)</li>
      <li>the struct points to a <a href="https://docs.oracle.com/javase/specs/jvms/se7/html/jvms-4.html#jvms-4.4.7" rel="noreferrer">CONSTANT_Utf8_info Structure</a> that contains the data. That is the only necessary data to represent the string.</li>
     </ul>
     <p>and the JVMS quote above seems to say that whenever the Utf8 pointed to is the same, then identical instances are loaded by <code>ldc</code>.</p>
     <p>I have done similar tests for fields, and:</p>
     <ul>
      <li><code>static final String s = "abc"</code> points to the constant table through the <a href="https://docs.oracle.com/javase/specs/jvms/se7/html/jvms-4.html#jvms-4.7.2" rel="noreferrer">ConstantValue Attribute</a></li>
      <li>non-final fields don't have that attribute, but can still be initialized with <code>ldc</code></li>
     </ul>
     <p><strong>Conclusion</strong>: there is direct bytecode support for the string pool, and the memory representation is efficient.</p>
     <p>Bonus: compare that to the <a href="https://stackoverflow.com/questions/13098143/java-integer-constant-pool">Integer pool</a>, which does not have direct bytecode support (i.e. no <code>CONSTANT_String_info</code> analogue).</p>
    </div>
    <hr>
    <div class="comment">
     <table>
     </table>
    </div>
   </div>
   <div>
    <h2 id="answer_5"><span>Answer 5</span> <span class="arrow"> <a href="#answer_4">↑</a> </span> <span class="arrow"> <a href="#answer_6">↓</a> </span></h2>
    <div class="container-metadata">
     <div>
      <span>Score: </span> <span>3</span>
     </div>
     <div>
      <span>Answerer: </span> <span>Amritansh</span>
     </div>
     <div>
      <span> Answered: </span> <span>15 Jan 2019 at 14:07</span>
     </div>
    </div>
    <div>
     <p>Any String literal gets created inside string literal pool and the pool doesn't allow any duplicates. Thus if two or more string objects are initialized with the same literal value then all objects will point to the same literal.</p>
     <pre><code>String obj1 = "abc";
String obj2 = "abc";
</code></pre>
     <p>"obj1" and "obj2" will point to the same string literal and the string literal pool will have only one "abc" literal.</p>
     <p>When we create a String class object using the new keyword the string thus created is stored in heap memory. Any string literal passed as parameter to the constructor of String class however is stored in string pool. If we create multiple objects using the same value with the new operator a new object will be created in the heap each time, because of this new operator should be avoided.</p>
     <pre><code>String obj1 = new String("abc");
String obj2 = new String("abc");
</code></pre>
     <p>"obj1" and "obj2" will point to two different objects in the heap and the string literal pool will have only one "abc" literal.</p>
     <p>Also something that is worth noting with regards to the behavior of strings is that any new assignment or concatenation done on string creates a new object in memory.</p>
     <pre><code>String str1 = "abc";
String str2 = "abc" + "def";
str1 = "xyz";
str2 = str1 + "ghi";
</code></pre>
     <p>Now in the above case:<br>
       Line 1: "abc" literal is stored in string pool.<br>
       Line 2: "abcdef" literal gets stored in the string pool.<br>
       Line 3: A new "xyz" literal is stored in the string pool and "str1" starts to point to this literal.<br>
       Line 4: Since the value is generated by appending to another variable the result is stored in the heap memory and the literal being appended "ghi" will be checked for its existence in the string pool and will be created since it doesn't exist in the above case.</p>
    </div>
    <hr>
    <div class="comment">
     <table>
     </table>
    </div>
   </div>
   <div>
    <h2 id="answer_6"><span>Answer 6</span> <span class="arrow"> <a href="#answer_5">↑</a> </span> <span class="arrow"> <a href="#answer_7">↓</a> </span></h2>
    <div class="container-metadata">
     <div>
      <span>Score: </span> <span>2</span>
     </div>
     <div>
      <span>Answerer: </span> <span>SDC</span>
     </div>
     <div>
      <span> Answered: </span> <span>7 Jul 2015 at 02:32</span>
     </div>
    </div>
    <div>
     <p>@Braj : i think u have mentioned the other way around. Please correct me if i am wrong</p>
     <p>Object creation line by line:</p>
     <p>String str1 = new String("java5")</p>
     <pre><code>   Pool- "java5" (1 Object)

   Heap - str1 =&gt; "java5" (1 Object)
</code></pre>
     <p>String str2 = "java5"</p>
     <pre><code>  pool- str2 =&gt; "java5" (1 Object)

  heap - str1 =&gt; "java5" (1 Object)
</code></pre>
     <p>String str3 = new String(str2)</p>
     <pre><code>  pool- str2 =&gt; "java5" (1 Object)

  heap- str1 =&gt; "java5", str3 =&gt; "java5" (2 Objects)
</code></pre>
     <p>String str4 = "java5"</p>
     <pre><code>  pool - str2 =&gt; str4 =&gt; "java5" (1 Object)

  heap - str1 =&gt; "java5", str3 =&gt; "java5" (2 Objects)
</code></pre>
    </div>
    <hr>
    <div class="comment">
     <table>
      <tbody>
       <tr>
        <td></td>
        <td><span><code>str1</code> is not involved in the value of <code>str2</code> or <code>str3</code> or <code>str4</code> in any way.</span> <span> - </span> <span class="display-name">user207421</span> <span> </span> <span class="date">7 Feb 2016 at 09:24</span></td>
       </tr>
      </tbody>
     </table>
    </div>
   </div>
   <div>
    <h2 id="answer_7"><span>Answer 7</span> <span class="arrow"> <a href="#answer_6">↑</a> </span> <span class="arrow"> <a href="#answer_8">↓</a> </span></h2>
    <div class="container-metadata">
     <div>
      <span>Score: </span> <span>1</span>
     </div>
     <div>
      <span>Answerer: </span> <span>b_erb</span>
     </div>
     <div>
      <span> Answered: </span> <span>16 Jun 2010 at 10:46</span>
     </div>
    </div>
    <div>
     <p>Think of <code>"bla"</code> being a magic factory like <code>Strings.createString("bla")</code> (pseudo). The factory holds a pool of all strings yet created this way.</p>
     <p>If it gets invoked, it checks if there is already string in the pool with this value. If true, it returns this string object, hence to strings obtained this way are indeed the same object.</p>
     <p>If not, it creates a new string object internally, saves it in the pool and then returns it. Thus, when the same string value is queried the next time, it returns the same instance.</p>
     <p>Manually creating <code>new String("")</code> overrides this behaviour by bypassing the string literal pool. So equality should always be checked using <code>equals()</code> which compares the character sequence instead of the object reference equality.</p>
    </div>
    <hr>
    <div class="comment">
     <table>
      <tbody>
       <tr>
        <td></td>
        <td><span>The 'magic factory' you refer to is nothing more or less than the Java compiler. It is a mistake to write of this process as though it occurred at runtime.</span> <span> - </span> <span class="display-name">user207421</span> <span> </span> <span class="date">7 Feb 2016 at 09:20</span></td>
       </tr>
      </tbody>
     </table>
    </div>
   </div>
   <div>
    <h2 id="answer_8"><span>Answer 8</span> <span class="arrow"> <a href="#answer_7">↑</a> </span> <span class="arrow"> <a href="#answer_9">↓</a> </span></h2>
    <div class="container-metadata">
     <div>
      <span>Score: </span> <span>1</span>
     </div>
     <div>
      <span>Answerer: </span> <span>Shashank T</span>
     </div>
     <div>
      <span> Answered: </span> <span>16 Jun 2010 at 11:19</span>
     </div>
    </div>
    <div>
     <p>One simple way to understand the difference is below:-</p>
     <pre><code>String s ="abc";
String s1= "abc";
String s2=new String("abc");

        if(s==s1){
            System.out.println("s==s1 is true");
        }else{
            System.out.println("s==s1 is false");
        }
        if(s==s2){
            System.out.println("s==s2 is true");
        }else{
            System.out.println("s==s2 is false");
        }
</code></pre>
     <p>output is</p>
     <pre><code>s==s1 is true
s==s2 is false
</code></pre>
     <p>Thus new String() will always create a new instance.</p>
    </div>
    <hr>
    <div class="comment">
     <table>
     </table>
    </div>
   </div>
   <div>
    <h2 id="answer_9"><span>Answer 9</span> <span class="arrow"> <a href="#answer_8">↑</a> </span> <span class="arrow"> <a href="#answer_10">↓</a> </span></h2>
    <div class="container-metadata">
     <div>
      <span>Score: </span> <span>1</span>
     </div>
     <div>
      <span>Answerer: </span> <span>fastcodejava</span>
     </div>
     <div>
      <span> Answered: </span> <span>17 Jun 2010 at 04:38</span>
     </div>
    </div>
    <div>
     <p>Although it looks the same from a programmers point of view, it has big performance impact. You would want to use the first form almost always.</p>
    </div>
    <hr>
    <div class="comment">
     <table>
     </table>
    </div>
   </div>
   <div>
    <h2 id="answer_10"><span>Answer 10</span> <span class="arrow"> <a href="#answer_9">↑</a> </span> <span class="arrow"> <a href="#answer_11">↓</a> </span></h2>
    <div class="container-metadata">
     <div>
      <span>Score: </span> <span>0</span>
     </div>
     <div>
      <span>Answerer: </span> <span>Jayesh</span>
     </div>
     <div>
      <span> Answered: </span> <span>15 Sep 2015 at 10:24</span>
     </div>
    </div>
    <div>
     <pre><code>String str = new String("hello")
</code></pre>
     <p>It will check whether String constant pool already contains String "hello"? If present then it will not add an entry in String constant pool. If not present then it will add an entry in String constant pool.</p>
     <p>An object will be created in a heap memory area and <code>str</code> reference points to object created in heap memory location.</p>
     <p>if you want <code>str</code> reference to point object containing in String constant pool then one has to explicitly call <code>str.intern();</code></p>
     <pre><code>String str = "world";
</code></pre>
     <p>It will check whether String constant pool already contains String "hello"? If present then it will not add an entry in String constant pool. If not present then it will add an entry in String constant pool.</p>
     <p>In both the above case, <code>str</code> reference points to String <code>"world"</code> present in Constant pool.</p>
    </div>
    <hr>
    <div class="comment">
     <table>
      <tbody>
       <tr>
        <td></td>
        <td><span>'It' being the Java compiler. The string literal creates a unique entry in the constant pool, at compile time. It's a mistake to deacribe this process as though it happens at runtime..</span> <span> - </span> <span class="display-name">user207421</span> <span> </span> <span class="date">7 Feb 2016 at 09:28</span></td>
       </tr>
       <tr>
        <td></td>
        <td><span>Can you please explain what is wrong in this post clearly?</span> <span> - </span> <span class="display-name">Jayesh</span> <span> </span> <span class="date">7 Feb 2016 at 09:46</span></td>
       </tr>
       <tr>
        <td></td>
        <td><span>What is wrong in this post is that the string literal is pooled at complle time, as I already said. Not when executing the code, as in your answer.</span> <span> - </span> <span class="display-name">user207421</span> <span> </span> <span class="date">22 Oct 2016 at 07:22</span></td>
       </tr>
       <tr>
        <td></td>
        <td><span>@EJP I appreciate your response. Can you please point out the exact line which is wrong in answer. I see all answers above are same as what i wrote. Please help, I want to correct my understanding. Thanks.</span> <span> - </span> <span class="display-name">Jayesh</span> <span> </span> <span class="date">22 Oct 2016 at 07:43</span></td>
       </tr>
       <tr>
        <td></td>
        <td><span>You have written about the entire process as though it all takes place when the line of code is executed, which, as I have repeatedly told you, is not the case. You can't reduce all that to a single 'exact line' being wrong in your answer.</span> <span> - </span> <span class="display-name">user207421</span> <span> </span> <span class="date">23 Aug 2017 at 04:02</span></td>
       </tr>
      </tbody>
     </table>
    </div>
   </div>
   <div>
    <h2 id="answer_11"><span>Answer 11</span> <span class="arrow"> <a href="#answer_10">↑</a> </span> <span class="arrow"> <a href="#answer_12">↓</a> </span></h2>
    <div class="container-metadata">
     <div>
      <span>Score: </span> <span>0</span>
     </div>
     <div>
      <span>Answerer: </span> <span>Syed Babar Ali Shah 3261-FBASB</span>
     </div>
     <div>
      <span> Answered: </span> <span>27 Jan 2019 at 10:41</span>
     </div>
    </div>
    <div>
     <p>When you store a String as</p>
     <pre><code>String string1 = "Hello";
</code></pre>
     <p>directly, then JVM creates a String object with the given price during a separate block of memory called String constant pool.</p>
     <p>And whenever we have a tendency to try and produce another String as</p>
     <pre><code>String string2 = "Hello";
</code></pre>
     <p>JVM verifies whether or not any String object with constant price exists within the String constant pool, if so, rather than making a brand new object JVM assigns the reference of the existing object to the new variable.</p>
     <p>And when we store String as</p>
     <pre><code>String string = new String("Hello");
</code></pre>
     <p>using the new keyword, a brand new object with the given price is made no matter the contents of the String constant pool.</p>
    </div>
    <hr>
    <div class="comment">
     <table>
     </table>
    </div>
   </div>
   <div>
    <h2 id="answer_12"><span>Answer 12</span> <span class="arrow"> <a href="#answer_11">↑</a> </span> <span class="arrow"> <a href="#answer_13">↓</a> </span></h2>
    <div class="container-metadata">
     <div>
      <span>Score: </span> <span>0</span>
     </div>
     <div>
      <span>Answerer: </span> <span>ThinkTank</span>
     </div>
     <div>
      <span> Answered: </span> <span>9 Aug 2020 at 09:33</span>
     </div>
    </div>
    <div>
     <p>Sorry for late Answer but much needed Answer. First we need to know some <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html" rel="nofollow noreferrer">Java.lang.String</a> Class rules.</p>
     <ol>
      <li>
       <p>String Literals e.g.<code>String str="java";</code> (we use only double Quotes) are different from String Object (we use new keyword) e.g. <code>String str=new String("java");</code></p></li>
      <li>
       <p><a href="https://stackoverflow.com/questions/1552301/immutability-of-strings-in-java">String is Immutable Object</a> i.e. If value changes a new Object is created and returned to you eg See <code>replace() and replaceAll()</code> functions and many more.</p></li>
      <li>
       <p>This creates a problem of many String Object in Modification, So creators of Java came up an Idea was called StringPool. StringPool is stored in heap area where object reference data will be stored as we know String is <code>Char[]</code>(<a href="https://www.tutorialspoint.com/what-are-compact-strings-in-java-9" rel="nofollow noreferrer">before java 9</a> very Long to read) or <code>byte</code>[](<a href="https://examples.javacodegeeks.com/core-java/java-9-compact-strings-example/" rel="nofollow noreferrer">after java 9</a> short to read).</p></li>
      <li>
       <p>String literals are stored in StringPool and String Objects are stored in as usual heap Object Area.</p></li>
      <li>
       <p>If there are many Object String Initialization JVM heap will be finished in String Operations only, Java Development team came up with <a href="https://www.tutorialspoint.com/java/lang/string_intern.htm" rel="nofollow noreferrer">intern()</a> solution this moves/changes memory reference to StringPool.</p>
       <p><a href="https://ide.geeksforgeeks.org/EhzgZAmAcj" rel="nofollow noreferrer">Program: Comparing String references to objects</a></p></li>
     </ol>
     <p><a href="https://ide.geeksforgeeks.org/coJvbfIi5m" rel="nofollow noreferrer">Another good link to understand java.lang.String better</a></p>
     <pre><code>import java.util.*; 

class GFG { 
    public static void main(String[] args) 
    { 
      String siteName1 = "java.com";
        String siteName2 = "java.com";
        String siteName3 = new String("java.com");
        String siteName4 = new String("java.com").intern();
      
    System.out.println("siteName1:::"+Integer.toHexString(System.identityHashCode(siteName1)));
      System.out.println("siteName2:::"+Integer.toHexString(System.identityHashCode(siteName2)));
      System.out.println("siteName3 creation Of New Object Without Interned:::"+Integer.toHexString(System.identityHashCode(siteName3)));//must be Diffrent bcoz new Object In Heap Area
      System.out.println("siteName4 creation Of New Object With Interned:::"+Integer.toHexString(System.identityHashCode(siteName4)));//must be same MemoryAddress of siteName1,siteName2 and Interned, bcoz Objects Points to String pool Now
      
      System.out.println(siteName1 == siteName2); // true
      System.out.println(siteName1 == siteName3); // false this tells about lietral vs String Objects
      String siteName5 = siteName3.intern(); // Interning will not change Original Object but gives us a new Object
      
      System.out.println("siteName5 Interned from siteName3:::"+Integer.toHexString(System.identityHashCode(siteName5)));//must be same MemoryAddress of siteName1,siteName2 and Interned, bcoz Objects Points to String pool Now
      
      System.out.println(siteName1 == siteName3); // false this tells about Immutability
      System.out.println(siteName1 == siteName5); // true After Intering both are same
      System.out.println(siteName1 == siteName4); // true
      System.out.println(siteName5 == siteName4); // true
    } 
}
</code></pre>
    </div>
    <hr>
    <div class="comment">
     <table>
     </table>
    </div>
   </div>
   <div>
    <h2 id="answer_13"><span>Answer 13</span> <span class="arrow"> <a href="#answer_12">↑</a> </span></h2>
    <div class="container-metadata">
     <div>
      <span>Score: </span> <span>0</span>
     </div>
     <div>
      <span>Answerer: </span> <span>Alireza Fattahi</span>
     </div>
     <div>
      <span> Answered: </span> <span>1 Nov 2022 at 07:22</span>
     </div>
    </div>
    <div>
     <p>When you use some thing like <code>new String("Hello World")</code> the <a href="https://spotbugs.github.io/" rel="nofollow noreferrer">SpotBugs</a> code analyze tool, complains a <strong>performance issue</strong>.</p>
     <p>The <a href="https://spotbugs.readthedocs.io/en/latest/bugDescriptions.html#DM_STRING_CTOR" rel="nofollow noreferrer">description</a> of this issue shows deference of <code>new</code> and <code>constant string</code></p>
     <blockquote>
      <p>Using the <code>java.lang.String(String)</code> constructor wastes memory because the object so constructed will be functionally indistinguishable from the String passed as a parameter.&nbsp; Just use the argument String directly.<br>
        Bug kind and pattern: Dm - DM_STRING_CTOR</p>
     </blockquote>
    </div>
    <hr>
    <div class="comment">
     <table>
     </table>
    </div>
   </div>
   <br>
   <div>
    <span>License: </span> <a href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a> <span>by </span> <a href="https://stackoverflow.com/legal/terms-of-service#licensing">Stack Overflow Inc.</a>
   </div>
  </div>
 </body>
</html>