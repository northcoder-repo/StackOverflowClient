<!doctype html>
<html lang="en">
 <head>
  <meta charset="UTF-8">
  <title>jQuery datatables export input text option and not export specific column at same time</title>
  <link rel="stylesheet" type="text/css" href="/css/base.css">
  <script type="text/x-mathjax-config">
            MathJax.Hub.Config({"HTML-CSS": { preferredFont: "TeX", availableFonts: ["STIX","TeX"], linebreaks: { automatic:true }, EqnChunk: (MathJax.Hub.Browser.isMobile ? 10 : 50) },
            tex2jax: { inlineMath: [ ["$", "$"], ["\\\\(","\\\\)"] ], displayMath: [ ["$$","$$"], ["\\[", "\\]"] ], processEscapes: true, ignoreClass: "tex2jax_ignore|dno" },
            TeX: {
            extensions: ["begingroup.js"],
            noUndefined: { attributes: { mathcolor: "red", mathbackground: "#FFEEEE", mathsize: "90%" } },
            Macros: { href: "{}" }
            },
            messageStyle: "none",
            styles: { ".MathJax_Display, .MathJax_Preview, .MathJax_Preview > *": { "background": "inherit" } },
            SEEditor: "mathjaxEditing"
            });
        </script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_HTML-full"></script>
 </head>
 <body>
  <div class="question">
   <a href="/questions">All Questions</a>
   <h2>jQuery datatables export input text option and not export specific column at same time</h2>
   <div class="container-metadata">
    <div>
     <span>Score: </span> <span>0</span>
    </div>
    <div>
     <span>Asker: </span> <span>Thameem</span>
    </div>
    <div>
     <span>Asked: </span> <span>2 Jun 2020 at 05:41</span>
    </div>
    <div>
     <a href="https://stackoverflow.com/questions/62145571/jquery-datatables-export-input-text-option-and-not-export-specific-column-at-sam">source</a>
    </div>
   </div>
   <div>
    <p>I've been struggling with this code. I need to avoid specific columns from being exported. I have done that but I don't know how to export the text inside any input element.</p>
    <p>Here is the code:</p>
    <pre><code>$("#campaignMaterialsTable table").DataTable({
                            dom: 'Bfrtip',
                            buttons: [
                                {
                                    extend: 'excel',
                                    className: 'export-button',
                                    text: 'Export as Excel',
                                    columns: ':not(.notexport)',
                                    //exportOptions: {
                                    //    format: {
                                    //        body: function (data, row, column, node) {
                                    //            //
                                    //            //check if type is input using jquery
                                    //            return $(data).is("input") ?
                                    //                $(data).val() :
                                    //                data;
                                    //        },
                                    //        columns: ':not(.notexport)'
                                    //    }
                                    //},
                                    title: 'Campaign Materials'
                                }]
                        });
</code></pre>
    <p>I don't know here to put the code at the right place.. while initializing..</p>
    <p>I referred to this links, but still not getting what I want:</p>
    <p><a href="https://datatables.net/forums/discussion/50724/export-values-typed-in-input-box-excelhtml5" rel="nofollow noreferrer">https://datatables.net/forums/discussion/50724/export-values-typed-in-input-box-excelhtml5</a></p>
    <p><a href="https://datatables.net/forums/discussion/42205/export-data-with-text-box-in-td-of-data-table#latest" rel="nofollow noreferrer">https://datatables.net/forums/discussion/42205/export-data-with-text-box-in-td-of-data-table#latest</a></p>
    <p><a href="https://datatables.net/extensions/buttons/examples/html5/outputFormat-function.html" rel="nofollow noreferrer">https://datatables.net/extensions/buttons/examples/html5/outputFormat-function.html</a></p>
    <p><a href="https://datatables.net/forums/discussion/50724/export-values-typed-in-input-box-excelhtml5" rel="nofollow noreferrer">https://datatables.net/forums/discussion/50724/export-values-typed-in-input-box-excelhtml5</a></p>
   </div>
   <div class="tags">
    <span class="tag">jquery</span><span class="tag">datatables</span>
   </div>
   <hr>
   <div class="comment">
    <table>
     <tbody>
      <tr>
       <td></td>
       <td><span>Please read <a href="//meta.stackoverflow.com/q/326569">Under what circumstances may I add “urgent” or other similar phrases to my question, in order to obtain faster answers?</a> - the summary is that this is not an ideal way to address volunteers, and is probably counterproductive to obtaining answers. Please refrain from adding this to your questions.</span> <span> - </span> <span class="display-name">halfer</span> <span> </span> <span class="date">2 Jun 2020 at 10:16</span></td>
      </tr>
      <tr>
       <td></td>
       <td><span>i didn't know that. but i was in a really urgent situation. thats why.. i thought i would get some help.. but i ran out of time..and found an alternate solution</span> <span> - </span> <span class="display-name">Thameem</span> <span> </span> <span class="date">2 Jun 2020 at 14:54</span></td>
      </tr>
     </tbody>
    </table>
   </div>
   <br>
   <div>
    <h2 id="answer_1"><span>Answer 1</span> <span class="arrow"> <a href="#answer_2">↓</a> </span></h2>
    <div class="container-metadata">
     <div>
      <span>Score: </span> <span>3</span>
     </div>
     <div>
      <span>Answerer: </span> <span>andrewJames</span>
     </div>
     <div>
      <span> Answered: </span> <span>2 Jun 2020 at 13:29</span>
     </div>
    </div>
    <div>
     <p>I assume you have a DataTable containing one or more input fields, something like this:</p>
     <p><a href="https://i.stack.imgur.com/An0VU.png" rel="nofollow noreferrer"><img src="An0VU.png" alt="enter image description here"></a></p>
     <p>The user can type values into the input fields.</p>
     <p>You want to export data to Excel, so that the result looks like this:</p>
     <p><a href="https://i.stack.imgur.com/33ArK.png" rel="nofollow noreferrer"><img src="33ArK.png" alt="enter image description here"></a></p>
     <p>Here we can see the user-provided data as well as the standard table data.</p>
     <p>To achieve this, I used the following table data:</p>
     <pre><code>&lt;table id="example" class="display nowrap dataTable cell-border" style="width:100%"&gt;
    &lt;thead&gt;
        &lt;tr&gt;
            &lt;th&gt;Name&lt;/th&gt;
            &lt;th&gt;Position&lt;/th&gt;
            &lt;th&gt;Office&lt;/th&gt;
            &lt;th&gt;Age&lt;/th&gt;
            &lt;th&gt;Start date&lt;/th&gt;
            &lt;th&gt;Salary&lt;/th&gt;
        &lt;/tr&gt;
    &lt;/thead&gt;
    &lt;tbody&gt;
        &lt;tr&gt;
            &lt;td&gt;Adélaïde Nixon&lt;/td&gt;
            &lt;td&gt;System Architect&lt;/td&gt;
            &lt;td&gt;&lt;input type="text" id="office" name="office"&gt;&lt;/td&gt;
            &lt;td&gt;432434&lt;/td&gt;
            &lt;td&gt;2011/04/25&lt;/td&gt;
            &lt;td&gt;$320,800&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
            &lt;td&gt;John Smith&lt;/td&gt;
            &lt;td&gt;Maager&lt;/td&gt;
            &lt;td&gt;&lt;input type="text" id="office" name="office"&gt;&lt;/td&gt;
            &lt;td&gt;6123&lt;/td&gt;
            &lt;td&gt;2011/04/25&lt;/td&gt;
            &lt;td&gt;$320,800&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
            &lt;td&gt;John Smith 2&lt;/td&gt;
            &lt;td&gt;Director&lt;/td&gt;
            &lt;td&gt;&lt;input type="text" id="office" name="office"&gt;&lt;/td&gt;
            &lt;td&gt;6123&lt;/td&gt;
            &lt;td&gt;2011/04/25&lt;/td&gt;
            &lt;td&gt;$320,800&lt;/td&gt;
        &lt;/tr&gt;
    &lt;/tbody&gt;
&lt;/table&gt;
</code></pre>
     <p>And I used the following DataTable initialization code:</p>
     <pre><code>&lt;script type="text/javascript"&gt;

  $(document).ready(function() {

    $('#example').DataTable({
      dom: 'Bfrtip',

      buttons: [
        {
          extend: 'excel',
          exportOptions: {
            format: {
              body: function ( inner, rowidx, colidx, node ) {
                if ($(node).children("input").length &gt; 0) {
                  return $(node).children("input").first().val();
                } else {
                  return inner;
                }
              }
            }
          }
        }
      ]

    });

  });
&lt;/script&gt;
</code></pre>
     <p>The <code>body</code> function assumes that, for input fields, there is only an <code>input</code> field in the cell (i.e. the input field is not contained in a <code>form</code> or any other element).</p>
     <p>It uses the node parameter to check for input data, to avoid data formatting issues that could occur (e.g. with dates). I recommend doing that rather than using <code>$(data).is("input")</code>.</p>
     <p>If there is no input field found in the cell, then the cell contents (<code>inner</code>) are returned.</p>
     <p>If the structure of your table does not match these assumptions, then you may need to adjust the above code, of course.</p>
     <h2>Edit</h2>
     <p>Regarding the follow-up question about choosing which columns to export, there are various ways.</p>
     <p>You can hard-code the column indexes you want to export (where index 0 means the first column). For example:</p>
     <pre><code>exportOptions: {
  columns: [ 0, 1, 2, 3, 5 ],
    format: {
      body: function ( inner, rowidx, colidx, node ) {
        if ($(node).children("input").length &gt; 0) {
          return $(node).children("input").first().val();
        } else {
          return inner;
        }
      }
    }
}
</code></pre>
     <p>This exports all columns apart from the Start Date column (index 4).</p>
     <p>Or you can use the approach in your question, based on a class, I believe. I have not actually tried that one.</p>
     <p>Take note of where the <code>columns: [ 0, 1, 2, 3, 5 ]</code> directive is placed - it is inside the <code>exportOptions</code> section.</p>
    </div>
    <hr>
    <div class="comment">
     <table>
      <tbody>
       <tr>
        <td></td>
        <td><span>thanks for the answer. i need to know how to merge the code for ignoring specific columns from being exported with the code you have provided. By the way i used another technique to solve my problem. i was in damn urgent in the morning. my boss was after me. cuz we had to deliver the project around 12: pm IST and i posted this question before &lt; 1hour for 12:00 pm.</span> <span> - </span> <span class="display-name">Thameem</span> <span> </span> <span class="date">2 Jun 2020 at 14:50</span></td>
       </tr>
       <tr>
        <td></td>
        <td><span>your code helps to export the data of any input element. how to merge the code for ignoring specific columns with your code..i hope you understand.</span> <span> - </span> <span class="display-name">Thameem</span> <span> </span> <span class="date">2 Jun 2020 at 14:51</span></td>
       </tr>
       <tr>
        <td></td>
        <td><span>very tired at the end of the day. i'll try myself again with the code you have provided tomorrow.</span> <span> - </span> <span class="display-name">Thameem</span> <span> </span> <span class="date">2 Jun 2020 at 15:04</span></td>
       </tr>
       <tr>
        <td>1</td>
        <td><span>I added an example for you.</span> <span> - </span> <span class="display-name">andrewJames</span> <span> </span> <span class="date">2 Jun 2020 at 15:09</span></td>
       </tr>
       <tr>
        <td></td>
        <td><span>the update you provided is working the either way. thanks</span> <span> - </span> <span class="display-name">Thameem</span> <span> </span> <span class="date">2 Jun 2020 at 15:33</span></td>
       </tr>
       <tr>
        <td>1</td>
        <td><span>@halfer - Edit noted; guidance appreciated.</span> <span> - </span> <span class="display-name">andrewJames</span> <span> </span> <span class="date">5 Jun 2020 at 13:43</span></td>
       </tr>
      </tbody>
     </table>
    </div>
   </div>
   <div>
    <h2 id="answer_2"><span>Answer 2</span> <span class="arrow"> <a href="#answer_1">↑</a> </span></h2>
    <div class="container-metadata">
     <div>
      <span>Score: </span> <span>1</span>
     </div>
     <div>
      <span>Answerer: </span> <span>Negi Rox</span>
     </div>
     <div>
      <span> Answered: </span> <span>2 Jun 2020 at 05:48</span>
     </div>
    </div>
    <div>
     <p>you can use</p>
     <pre><code>exportOptions:{
       columns: ':visible'
 }
</code></pre>
     <p>in below buttons</p>
     <pre><code>buttons: [
   {
       extend: 'pdf',
       footer: true,
        exportOptions: {
            columns: ':visible'
        }


   },
</code></pre>
     <p>it will export only visible columns</p>
    </div>
    <hr>
    <div class="comment">
     <table>
      <tbody>
       <tr>
        <td></td>
        <td><span>Thanks for the answer. But i also need to merge the code for exporting the text inside the input element. can you help me with that..i have included that code in the question - its commented</span> <span> - </span> <span class="display-name">Thameem</span> <span> </span> <span class="date">2 Jun 2020 at 05:49</span></td>
       </tr>
       <tr>
        <td></td>
        <td><span>This code -&gt; return $(data).is("input") ?$(data).val() :data;</span> <span> - </span> <span class="display-name">Thameem</span> <span> </span> <span class="date">2 Jun 2020 at 05:50</span></td>
       </tr>
       <tr>
        <td></td>
        <td><span>merge the above code with Columns: ":not(not-export)" options</span> <span> - </span> <span class="display-name">Thameem</span> <span> </span> <span class="date">2 Jun 2020 at 05:50</span></td>
       </tr>
      </tbody>
     </table>
    </div>
   </div>
   <br>
   <div>
    <span>License: </span> <a href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a> <span>by </span> <a href="https://stackoverflow.com/legal/terms-of-service#licensing">Stack Overflow Inc.</a>
   </div>
  </div>
 </body>
</html>