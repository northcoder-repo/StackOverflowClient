<!doctype html>
<html lang="en">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>DataTable with clickable TD, display controls on click with hide and update on blur using jQuery</title>
  <link rel="stylesheet" type="text/css" href="/css/base.css">
  <script type="text/x-mathjax-config">
            MathJax.Hub.Config({"HTML-CSS": { preferredFont: "TeX", availableFonts: ["STIX","TeX"], linebreaks: { automatic:true }, EqnChunk: (MathJax.Hub.Browser.isMobile ? 10 : 50) },
            tex2jax: { inlineMath: [ ["$", "$"], ["\\\\(","\\\\)"] ], displayMath: [ ["$$","$$"], ["\\[", "\\]"] ], processEscapes: true, ignoreClass: "tex2jax_ignore|dno" },
            TeX: {
            extensions: ["begingroup.js"],
            noUndefined: { attributes: { mathcolor: "red", mathbackground: "#FFEEEE", mathsize: "90%" } },
            Macros: { href: "{}" }
            },
            messageStyle: "none",
            styles: { ".MathJax_Display, .MathJax_Preview, .MathJax_Preview > *": { "background": "inherit" } },
            SEEditor: "mathjaxEditing"
            });
        </script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_HTML-full"></script>
 </head>
 <body>
  <div class="question">
   <a href="/questions">All Questions</a>
   <h2>DataTable with clickable TD, display controls on click with hide and update on blur using jQuery</h2>
   <div class="container-metadata">
    <div>
     <span>Score: </span> <span>0</span>
    </div>
    <div>
     <span>Asker: </span> <span>Sumeet Kumar</span>
    </div>
    <div>
     <span>Asked: </span> <span>29 Apr 2023 at 18:10</span>
    </div>
    <div>
     <a href="https://stackoverflow.com/questions/76137708/datatable-with-clickable-td-display-controls-on-click-with-hide-and-update-on-b">source</a>
    </div>
   </div>
   <div>
    <p>In the datatable columns are filled with values. When I am clicking on TD cell and getting the value of cell but the alert get repeated. But I want it one time only. Also the cell should get display with select option for first 2 columns and input text for another 2 columns with the TD cell value.</p>
    <p>Below is the code and I have made an <code>onClick</code> event on each <code>TD</code> to get the value. But how should I make the alert should popup once and to display select option and input box.? Also how should get the controls hide when clicked on outside of datatable?</p>
    <p></p>
    <div class="snippet" data-lang="js" data-hide="false" data-console="true" data-babel="false">
     <div class="snippet-code">
      <pre class="snippet-code-js lang-js prettyprint-override"><code>&lt;script src="https://code.jquery.com/jquery-3.6.0.min.js"&gt;&lt;/script&gt;
    &lt;link href="https://cdn.datatables.net/1.13.4/css/jquery.dataTables.min.css" rel="stylesheet" /&gt;
    &lt;link href="https://cdn.datatables.net/buttons/2.3.6/css/buttons.dataTables.min.css" rel="stylesheet" /&gt;

    &lt;script src="https://code.jquery.com/jquery-3.5.1.js" type="text/javascript"&gt;&lt;/script&gt;
    &lt;script src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js" type="text/javascript"&gt;&lt;/script&gt;
    &lt;script src="https://cdn.datatables.net/buttons/2.3.6/js/dataTables.buttons.min.js" type="text/javascript"&gt;&lt;/script&gt;
    &lt;script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js" type="text/javascript"&gt;&lt;/script&gt;
    &lt;script src="https://cdn.datatables.net/buttons/2.3.6/js/buttons.html5.min.js" type="text/javascript"&gt;&lt;/script&gt;

    &lt;script&gt;
        $(document).ready(function () {
            $('#example').DataTable();
        });

        function Edit(n) {
            $('.clickable').click(function (e) {
                var val1 = $(this).text();
                alert(val1);
                return;
            });
        }

    &lt;/script&gt;</code></pre>
      <pre class="snippet-code-html lang-html prettyprint-override"><code>&lt;form id="form1" runat="server"&gt;
        &lt;div id="GridView"&gt;
            &lt;table id="example" class="display" style="width: 100%"&gt;
                &lt;thead&gt;
                    &lt;tr&gt;
                        &lt;th&gt;Name&lt;/th&gt;
                        &lt;th&gt;Position&lt;/th&gt;
                        &lt;th&gt;Office&lt;/th&gt;
                        &lt;th&gt;Age&lt;/th&gt;
                        &lt;th&gt;Start date&lt;/th&gt;
                        &lt;th&gt;Salary&lt;/th&gt;
                    &lt;/tr&gt;
                &lt;/thead&gt;
                &lt;tbody&gt;
                    &lt;tr&gt;
                        &lt;td onclick="Edit('1')" class="clickable"&gt;Tiger Nixon&lt;/td&gt;
                        &lt;td onclick="Edit('2')" class="clickable"&gt;System Architect&lt;/td&gt;
                        &lt;td onclick="Edit('3')" class="clickable"&gt;Edinburgh&lt;/td&gt;
                        &lt;td onclick="Edit('4')" class="clickable"&gt;61&lt;/td&gt;
                        &lt;td onclick="Edit('5')" class="clickable"&gt;2011-04-25&lt;/td&gt;
                        &lt;td onclick="Edit('6')" class="clickable"&gt;$320,800&lt;/td&gt;
                    &lt;/tr&gt;
                    &lt;tr&gt;
                        &lt;td onclick="Edit('1')" class="clickable"&gt;Garrett Winters&lt;/td&gt;
                        &lt;td onclick="Edit('2')" class="clickable"&gt;Accountant&lt;/td&gt;
                        &lt;td onclick="Edit('3')" class="clickable"&gt;Tokyo&lt;/td&gt;
                        &lt;td onclick="Edit('4')" class="clickable"&gt;63&lt;/td&gt;
                        &lt;td onclick="Edit('5')" class="clickable"&gt;2011-07-25&lt;/td&gt;
                        &lt;td onclick="Edit('6')" class="clickable"&gt;$170,750&lt;/td&gt;
                    &lt;/tr&gt;
                    &lt;tr&gt;
                        &lt;td onclick="Edit('1')" class="clickable"&gt;Ashton Cox&lt;/td&gt;
                        &lt;td onclick="Edit('2')" class="clickable"&gt;Junior Technical Author&lt;/td&gt;
                        &lt;td onclick="Edit('3')" class="clickable"&gt;San Francisco&lt;/td&gt;
                        &lt;td onclick="Edit('4')" class="clickable"&gt;66&lt;/td&gt;
                        &lt;td onclick="Edit('5')" class="clickable"&gt;2009-01-12&lt;/td&gt;
                        &lt;td onclick="Edit('6')"&gt;$86,000&lt;/td&gt;
                    &lt;/tr&gt;
                &lt;/tbody&gt;
                &lt;tfoot&gt;
                    &lt;tr&gt;
                        &lt;th&gt;Name&lt;/th&gt;
                        &lt;th&gt;Position&lt;/th&gt;
                        &lt;th&gt;Office&lt;/th&gt;
                        &lt;th&gt;Age&lt;/th&gt;
                        &lt;th&gt;Start date&lt;/th&gt;
                        &lt;th&gt;Salary&lt;/th&gt;
                    &lt;/tr&gt;
                &lt;/tfoot&gt;
            &lt;/table&gt;
        &lt;/div&gt;
    &lt;/form&gt;</code></pre>
     </div>
    </div>
    <p></p>
   </div>
   <div class="tags">
    <span class="tag">jquery</span><span class="tag">datatable</span>
   </div>
   <hr>
   <div class="comment">
    <table>
     <tbody>
      <tr>
       <td></td>
       <td><span>It's not entirely clear (to me) what you are asking. Can you provide a <a href="https://stackoverflow.com/help/minimal-reproducible-example">minimal reproducible example</a> showing only the relevant code (and some data, please)? For example, why is there Excel related code in your question? Is that relevant to the <i>specific</i> problem you are asking about? If not, then remove it from your MRE. What would a successful outcome look like? Can you show us (e.g. using static data) instead of only trying to describe it? You can also use <a href="https://meta.stackoverflow.com/q/358992/12567365">stack snippets</a> to make your MRE code runnable.</span> <span> - </span> <span class="display-name">andrewJames</span> <span> </span> <span class="date">29 Apr 2023 at 18:27</span></td>
      </tr>
      <tr>
       <td></td>
       <td><span>@andrewJames The question is edited with the <code>RunSnippet</code>.</span> <span> - </span> <span class="display-name">Sumeet Kumar</span> <span> </span> <span class="date">30 Apr 2023 at 13:51</span></td>
      </tr>
      <tr>
       <td></td>
       <td><span>Yes, thank you for the edits - I saw your updates. Unfortunately, what you have provided is not a MRE. Also, when I try to run the code you have provided, it just throws a syntax error.</span> <span> - </span> <span class="display-name">andrewJames</span> <span> </span> <span class="date">30 Apr 2023 at 13:54</span></td>
      </tr>
      <tr>
       <td></td>
       <td><span>@andrewJames The error shown is for <code>https://stacksnippets.net/js</code> this path. But I didn't used this path anywhere in my code</span> <span> - </span> <span class="display-name">Sumeet Kumar</span> <span> </span> <span class="date">30 Apr 2023 at 14:25</span></td>
      </tr>
      <tr>
       <td></td>
       <td><span>You have a <i>syntax</i> error in your code. Read the error message again.</span> <span> - </span> <span class="display-name">andrewJames</span> <span> </span> <span class="date">30 Apr 2023 at 14:37</span></td>
      </tr>
      <tr>
       <td></td>
       <td><span>You are using a Stack Snippet! That is why <code>https://stacksnippets.net/js</code> is mentioned. But the <i>error</i> you need to fix is this: <code>"message": "SyntaxError: expected expression, got '&lt;'"</code>. It even tells you which line of your code to look at: <code>"lineno": 63</code>.</span> <span> - </span> <span class="display-name">andrewJames</span> <span> </span> <span class="date">30 Apr 2023 at 14:38</span></td>
      </tr>
      <tr>
       <td></td>
       <td><span>OK - I guess the line number of the error is not very helpful. Suggestion: Edit your stack snippet code. The stack snippet panel has 4 sections: (1) HTML. (2) JavaScript. (3) CSS. (4) Output. Look at your JavaScript panel. It has quite a lot of HTML in it. That is causing the error message you see. Take a closer look at the <a href="https://meta.stackoverflow.com/q/358992/12567365">instructions</a> I previously linked to, which describe how to create a stack snippet. Take note of the "<i>with no wrapper</i>" instructions, also.</span> <span> - </span> <span class="display-name">andrewJames</span> <span> </span> <span class="date">30 Apr 2023 at 20:33</span></td>
      </tr>
     </tbody>
    </table>
   </div>
   <br>
   <div>
    <h2 id="answer_1"><span>Answer 1</span></h2>
    <div class="container-metadata">
     <div>
      <span>Score: </span> <span>0</span>
     </div>
     <div>
      <span>Answerer: </span> <span>andrewJames</span>
     </div>
     <div>
      <span> Answered: </span> <span>30 Apr 2023 at 14:35</span>
     </div>
    </div>
    <div>
     <p>This is not a complete answer, because I am not sure what exactly you are trying to achieve (especially regarding the drop-down functionality you mention).</p>
     <p>But maybe this partial answer will point you in the right direction.</p>
     <p>It handles editable cells.</p>
     <p></p>
     <div class="snippet" data-lang="js" data-hide="false" data-console="true" data-babel="false">
      <div class="snippet-code">
       <pre class="snippet-code-js lang-js prettyprint-override"><code>var my_data = [{
    "id": "123",
    "name": "Tiger Nixon",
    "position": "System Architect",
    "salary": "$320,800",
    "notes": "lorem ipsum",
    "office": "Edinburgh",
    "extn": "5421"
  },
  {
    "id": "456",
    "name": "Donna Snider",
    "position": "Customer Support",
    "salary": "$112,000",
    "notes": "dolor sit amet",
    "office": "New York",
    "extn": "4226"
  }
];

$(document).ready(function() {

  const originals = new Map(); // tracks edits

  var table = $('#example').DataTable({
    data: my_data,
    columns: [{
        title: "ID",
        data: "id"
      },
      {
        title: "Name",
        data: "name"
      },
      {
        title: "Office",
        data: "office"
      },
      {
        title: "Position",
        data: "position"
      },
      {
        title: "Notes",
        data: "notes"
      },
      {
        title: "Extn.",
        data: "extn"
      },
      {
        title: "Salary",
        data: "salary"
      }
    ],
    columnDefs: [{
      targets: [1, 2, 3, 4],
      createdCell: function(td, cellData, rowData, rowIdx, colIdx) {
        td.setAttribute('contenteditable', true);
        td.setAttribute('spellcheck', false);
        td.addEventListener("focus", function(e) {
          originals.set(rowIdx + ':' + colIdx, e.target.textContent);
        });
        td.addEventListener("blur", function(e) {
          if (originals.get(rowIdx + ':' + colIdx) !== e.target.textContent) {
            $('#example').DataTable().cell(rowIdx, colIdx).data(td.innerHTML);
          }
        });
      }
    }]

  });

});</code></pre>
       <pre class="snippet-code-html lang-html prettyprint-override"><code>&lt;!doctype html&gt;
&lt;html&gt;

&lt;head&gt;
  &lt;meta charset="UTF-8"&gt;
  &lt;title&gt;Demo&lt;/title&gt;
  &lt;script src="https://code.jquery.com/jquery-3.5.1.js"&gt;&lt;/script&gt;
  &lt;script src="https://cdn.datatables.net/1.10.22/js/jquery.dataTables.js"&gt;&lt;/script&gt;
  &lt;link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.22/css/jquery.dataTables.css"&gt;
  &lt;link rel="stylesheet" type="text/css" href="https://datatables.net/media/css/site-examples.css"&gt;

&lt;/head&gt;

&lt;body&gt;

  &lt;div style="margin: 20px;"&gt;

    &lt;table id="example" class="display dataTable cell-border" style="width:100%"&gt;
    &lt;/table&gt;

  &lt;/div&gt;

&lt;/body&gt;

&lt;/html&gt;</code></pre>
      </div>
     </div>
     <p></p>
     <p>The Name, Office, Position, and Notes columns are editable. Just click on a cell to edit the contents. Click somewhere else to save the edits.</p>
     <p>The code uses <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Global_attributes/contenteditable" rel="nofollow noreferrer"><code>contenteditable</code></a> to make data editable.</p>
     <p>It uses a map to capture pre-edit values:</p>
     <pre><code>const originals = new Map();
</code></pre>
     <p>This is just to avoid unnecessary work, if the user doesn't actually make an edit change to a cell.</p>
     <p>The new value provided by the user's edits is saved back to the underlying DataTable using <a href="https://datatables.net/reference/api/cell().data()" rel="nofollow noreferrer"><code>cell().data()</code></a>:</p>
     <pre><code>$('#example').DataTable().cell(rowIdx, colIdx).data(td.innerHTML);
</code></pre>
     <p>We don't even bother to re-draw the DataTable, after doing this, as the display is already up-to-date.</p>
     <hr>
     <p><strong>Suggestion</strong></p>
     <p>Take the above code and see if it works the way you need.</p>
     <p>Then, if it does, maybe you can see if you can add drop-down logic, in a similar way. You can build a dropdown using the following basic approach:</p>
     <pre class="lang-js prettyprint-override"><code>var arr = [
  {val : 0, text: ''},
  {val : 1, text: 'Edinburgh'},
  {val : 2, text: 'New York'}
];
var sel = $('&lt;select&gt;').appendTo(td);
$(arr).each(function() {
  sel.append($("&lt;option&gt;").attr('value',this.val).text(this.text));
});
</code></pre>
     <p>Depending on what you actually need, I think there is probably a lot more logic needed - espeically to manage the changes between showing a drop-down and showing a plain (selected) value.</p>
     <p>But I have not tried this (and I'm not sure I would even know how to do it, myself).</p>
     <p>Maybe you can try for yourself and ask a new, <em>specific</em> question, if you run into a new <em>specific</em> problem.</p>
    </div>
    <hr>
    <div class="comment">
     <table>
     </table>
    </div>
   </div>
   <br>
   <div>
    <span>License: </span> <a href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a> <span>by </span> <a href="https://stackoverflow.com/legal/terms-of-service#licensing">Stack Overflow Inc.</a>
   </div>
  </div>
 </body>
</html>