<!doctype html>
<html lang="en">
 <head>
  <meta charset="UTF-8">
  <title>Invalid Date when trying to sort by date on datatable</title>
  <link rel="stylesheet" type="text/css" href="/css/base.css">
  <script type="text/x-mathjax-config">
            MathJax.Hub.Config({"HTML-CSS": { preferredFont: "TeX", availableFonts: ["STIX","TeX"], linebreaks: { automatic:true }, EqnChunk: (MathJax.Hub.Browser.isMobile ? 10 : 50) },
            tex2jax: { inlineMath: [ ["$", "$"], ["\\\\(","\\\\)"] ], displayMath: [ ["$$","$$"], ["\\[", "\\]"] ], processEscapes: true, ignoreClass: "tex2jax_ignore|dno" },
            TeX: {
            extensions: ["begingroup.js"],
            noUndefined: { attributes: { mathcolor: "red", mathbackground: "#FFEEEE", mathsize: "90%" } },
            Macros: { href: "{}" }
            },
            messageStyle: "none",
            styles: { ".MathJax_Display, .MathJax_Preview, .MathJax_Preview > *": { "background": "inherit" } },
            SEEditor: "mathjaxEditing"
            });
        </script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_HTML-full"></script>
 </head>
 <body>
  <div class="question">
   <a href="/questions">All Questions</a>
   <h2>Invalid Date when trying to sort by date on datatable</h2>
   <div class="container-metadata">
    <div>
     <span>Score: </span> <span>0</span>
    </div>
    <div>
     <span>Asker: </span> <span>Juan94</span>
    </div>
    <div>
     <span>Asked: </span> <span>26 Aug 2020 at 23:37</span>
    </div>
    <div>
     <a href="https://stackoverflow.com/questions/63607144/invalid-date-when-trying-to-sort-by-date-on-datatable">source</a>
    </div>
   </div>
   <div>
    <p>Hello everyone im trying to sort a data-table by dates i've tried to use moment js however doesn't seem to work at all.</p>
    <p><a href="https://i.stack.imgur.com/z5601.png" rel="nofollow noreferrer"><img src="https://i.stack.imgur.com/z5601.png" alt="enter image description here"></a></p>
    <p>I keep getting the "invalid date" message on the date row.</p>
    <p>The information for the data-table comes from the server, and i receive it like this:</p>
    <pre><code>returnedData["ingresos"].forEach(function(ingreso){
                    $("#Parte-data").append("&lt;tr&gt;&lt;td&gt;&lt;center&gt;" + ingreso["fecha_ingreso"] + "&lt;/center&gt;&lt;/td&gt;&lt;td&gt;&lt;center&gt;" + ingreso["codigo"] + "&lt;/center&gt;&lt;/td&gt;&lt;td&gt;&lt;center&gt; -- &lt;/center&gt;&lt;/td&gt;&lt;td&gt;&lt;center&gt;" + ingreso["orden_ingreso"] + "&lt;/center&gt;&lt;/td&gt;&lt;td&gt;&lt;center&gt; -- &lt;/center&gt;&lt;/td&gt;&lt;td&gt;&lt;center&gt;" + ingreso["balance"] + "&lt;/center&gt;&lt;/td&gt;&lt;td&gt;&lt;center&gt;" + ingreso["cantidad_ingresada"] + "&lt;/center&gt;&lt;/td&gt;&lt;td&gt;&lt;center&gt; -- &lt;/center&gt;&lt;/td&gt;&lt;td&gt;&lt;center&gt;" + ingreso["usuario"]["nombre"] + "&lt;/center&gt;&lt;/td&gt;&lt;/tr&gt;");
                });
                
                returnedData["salidas"].forEach(function(salida){
                    
                    $("#Parte-data").append("&lt;tr&gt;&lt;td&gt;&lt;center&gt;" + salida["fecha_salida"] + "&lt;/center&gt;&lt;/td&gt;&lt;td&gt;&lt;center&gt;" + salida["codigo"] + "&lt;/center&gt;&lt;/td&gt;&lt;td&gt;&lt;center&gt;" + salida["contrato"] + "&lt;/center&gt;&lt;/td&gt;&lt;td&gt;&lt;center&gt;" + tg + "&lt;/center&gt;&lt;/td&gt;&lt;td&gt;&lt;center&gt;" + salida["cantidad_salida"] + "&lt;/center&gt;&lt;/td&gt;&lt;td&gt;&lt;center&gt;" + salida["balance"] + "&lt;/center&gt;&lt;/td&gt;&lt;td&gt;&lt;center&gt; -- &lt;/center&gt;&lt;/td&gt;&lt;td&gt;&lt;center&gt;" + salida["tecnico"]["nombre"] + "&lt;/center&gt;&lt;/td&gt;&lt;td&gt;&lt;center&gt;" + salida["usuario"]["nombre"] + "&lt;/center&gt;&lt;/td&gt;&lt;/tr&gt;");
                });
</code></pre>
    <p>The information comes from "ingresos" and from "salidas", and in the data-table i tried this:</p>
    <pre><code>table = $('#Data-parte').DataTable({
                ordering: false,
                pageLength: 25,
                responsive: true,
                dom: '&lt;"html5buttons"B&gt;lTfgitp',
                
                columnDefs:[{
                    targets: 0,
                    render: $.fn.dataTable.render.moment('DD-MM-YYYY', 'DD-MM-YYYY'),
                }],
            });
</code></pre>
    <p>The format of the dates i get from the server is dd-mm-yyyy.</p>
    <p>Here is the data I get from the server:</p>
    <p><a href="https://i.stack.imgur.com/32ss4.png" rel="nofollow noreferrer"><img src="https://i.stack.imgur.com/32ss4.png" alt="enter image description here"></a></p>
    <p>Fields used in the dataTable are "fecha_ingreso" from "ingresos" and "fecha_salida" from "salidas".</p>
    <p>I don't understand what is missing, hope somebody can help me with this please :(</p>
   </div>
   <div class="tags">
    <span class="tag">jquery</span><span class="tag">datatable</span><span class="tag">datatables</span><span class="tag">momentjs</span>
   </div>
   <hr>
   <div class="comment">
    <table>
     <tbody>
      <tr>
       <td></td>
       <td><span>Can you show us a sample of the raw data you are getting from the server?</span> <span> - </span> <span class="display-name">andrewJames</span> <span> </span> <span class="date">26 Aug 2020 at 23:51</span></td>
      </tr>
      <tr>
       <td></td>
       <td><span>Also, is the moment function operating on the raw date string or on your updated string (where the data is embedded in some HTML)? <code>&lt;tr&gt;&lt;td&gt;&lt;center&gt;26-08-2020&lt;/center&gt;&lt;/td&gt;&lt;td&gt;&lt;center&gt;</code> - thanks for clarifications.</span> <span> - </span> <span class="display-name">andrewJames</span> <span> </span> <span class="date">26 Aug 2020 at 23:54</span></td>
      </tr>
      <tr>
       <td></td>
       <td><span>i added the data from the server</span> <span> - </span> <span class="display-name">Juan94</span> <span> </span> <span class="date">26 Aug 2020 at 23:56</span></td>
      </tr>
      <tr>
       <td></td>
       <td><span>The table is called after the "ingresos" and "salidas" are called so yea it is operating on the updated when everything is added</span> <span> - </span> <span class="display-name">Juan94</span> <span> </span> <span class="date">26 Aug 2020 at 23:58</span></td>
      </tr>
      <tr>
       <td></td>
       <td><span>OK - so that's not a valid date It's a date embedded in HTML. You can pass the raw date to DataTables and then use a DataTables <code>columnDefs.render</code> function to build the display value - and also a separate <a href="https://datatables.net/manual/data/orthogonal-data" rel="nofollow noreferrer">orthogonal data</a> value for sensible sorting (with help from moment.js). For example, the sort value could be YYYY-MM-DD.</span> <span> - </span> <span class="display-name">andrewJames</span> <span> </span> <span class="date">27 Aug 2020 at 00:04</span></td>
      </tr>
      <tr>
       <td></td>
       <td><span>I placed the table before the returneddata parts and the message stopped, however its not sorting correctly still :/</span> <span> - </span> <span class="display-name">Juan94</span> <span> </span> <span class="date">27 Aug 2020 at 00:13</span></td>
      </tr>
     </tbody>
    </table>
   </div>
   <br>
   <div>
    <h2 id="answer_1"><span>Answer 1</span></h2>
    <div class="container-metadata">
     <div>
      <span>Score: </span> <span>0</span>
     </div>
     <div>
      <span>Answerer: </span> <span>andrewJames</span>
     </div>
     <div>
      <span> Answered: </span> <span>27 Aug 2020 at 02:10</span>
     </div>
    </div>
    <div>
     <p>Here is an example using some standard test data, just to illustrate the approach I was referring to in my comments.</p>
     <p>The dates are displayed in the table in your format of DD-MM-YYYY, but they use an orthogonal format (YYYYMMDD) for sorting, which is hidden, behind the scenes.</p>
     <p>The example also uses a render function to wrap your data in the HTML you want to use.</p>
     <pre><code>&lt;!doctype html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
  &lt;meta charset="UTF-8"&gt;
  &lt;title&gt;Demo&lt;/title&gt;
  &lt;script src="https://code.jquery.com/jquery-3.5.1.min.js"&gt;&lt;/script&gt;
  &lt;script src="https://cdn.datatables.net/1.10.21/js/jquery.dataTables.min.js"&gt;&lt;/script&gt;
  &lt;link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.21/css/jquery.dataTables.min.css"&gt;
  &lt;link rel="stylesheet" type="text/css" href="https://datatables.net/media/css/site-examples.css"&gt;

  &lt;script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.27.0/moment.min.js"&gt;&lt;/script&gt;

&lt;/head&gt;

&lt;body&gt;

&lt;div style="margin: 20px;"&gt;

    &lt;table id="example" class="display dataTable cell-border" style="width:100%"&gt;
        &lt;thead&gt;
            &lt;tr&gt;
                &lt;th&gt;Name&lt;/th&gt;
                &lt;th&gt;Position&lt;/th&gt;
                &lt;th&gt;Office&lt;/th&gt;
                &lt;th&gt;Age&lt;/th&gt;
                &lt;th&gt;Start date&lt;/th&gt;
                &lt;th&gt;Salary&lt;/th&gt;
            &lt;/tr&gt;
        &lt;/thead&gt;
        &lt;tbody&gt;
            &lt;tr&gt;
                &lt;td&gt;Tiger Nixon&lt;/td&gt;
                &lt;td&gt;System Architect&lt;/td&gt;
                &lt;td&gt;Edinburgh&lt;/td&gt;
                &lt;td&gt;61&lt;/td&gt;
                &lt;td&gt;03-08-2020&lt;/td&gt;
                &lt;td&gt;$320,800&lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
                &lt;td&gt;Garrett Winters&lt;/td&gt;
                &lt;td&gt;Accountant&lt;/td&gt;
                &lt;td&gt;Tokyo&lt;/td&gt;
                &lt;td&gt;63&lt;/td&gt;
                &lt;td&gt;14-06-2020&lt;/td&gt;
                &lt;td&gt;$170,750&lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
                &lt;td&gt;Ashton Cox&lt;/td&gt;
                &lt;td&gt;Junior Technical Author&lt;/td&gt;
                &lt;td&gt;San Francisco&lt;/td&gt;
                &lt;td&gt;66&lt;/td&gt;
                &lt;td&gt;25-12-2019&lt;/td&gt;
                &lt;td&gt;$86,000&lt;/td&gt;
            &lt;/tr&gt;
        &lt;/tbody&gt;
    &lt;/table&gt;

&lt;/div&gt;

&lt;script type="text/javascript"&gt;

  $(document).ready(function() {

    $('#example').DataTable( {
      columnDefs:[{
        targets: 4,
        render: function ( data, type, row ) {
          //console.log(data); // the raw date as a string
          var d = moment(data, 'DD-MM-YYYY'); // converted to a moment object
          var sortString = moment(d).format('YYYYMMDD'); // converted to a new string format
          //console.log(sortString);
          var cellContents = '&lt;center&gt;' + data + '&lt;/center&gt;';
          if ( type === 'display' || type === 'filter' ) {
            return cellContents;
          } else {
            return sortString;
          }
        }
      }]
    } );

} );

&lt;/script&gt;

&lt;/body&gt;
&lt;/html&gt;
</code></pre>
     <p>The table looks like this:</p>
     <p><a href="https://i.stack.imgur.com/XOcdh.png" rel="nofollow noreferrer"><img src="https://i.stack.imgur.com/XOcdh.png" alt="enter image description here"></a></p>
     <p>Note how the date column is sorted chronologically (oldest to newest) using your display format.</p>
     <p>The key points to note are:</p>
     <ol>
      <li>
       <p>The render function is for column index 4 in my case (the 5th displayed column).</p></li>
      <li>
       <p>The column is centered in the cell because of the extra HTML I added.</p></li>
      <li>
       <p>The render function provides 2 orthogonal values: (a) the display value (html and date string), and also (b) a second date format for sorting (yyyymmdd).</p></li>
      <li>
       <p>For the <code>type === 'display' || type === 'filter'</code> line, these are two of the orthogonal data values I mentioned - <a href="https://datatables.net/manual/data/orthogonal-data#Computed-values" rel="nofollow noreferrer">see more information here</a>. By default the sort date is used for the <code>sort</code> orthogonal type: <code>else { return sortString; }</code></p></li>
     </ol>
    </div>
    <hr>
    <div class="comment">
     <table>
      <tbody>
       <tr>
        <td></td>
        <td><span>i appreciate the effort a lot, however i tested your solution and sorting still wrong :( keeps showing first the "ingresos" then "salidas" instead of ordering them by the date</span> <span> - </span> <span class="display-name">Juan94</span> <span> </span> <span class="date">27 Aug 2020 at 02:33</span></td>
       </tr>
       <tr>
        <td></td>
        <td><span>@Juan94 - Can you edit your question to show the latest version of your code, and to show the problem you are having? (Also, if possible, can you show the problem using a <a href="https://jsfiddle.net/" rel="nofollow noreferrer">fiddle</a>?)</span> <span> - </span> <span class="display-name">andrewJames</span> <span> </span> <span class="date">27 Aug 2020 at 12:59</span></td>
       </tr>
      </tbody>
     </table>
    </div>
   </div>
   <br>
   <div>
    <span>License: </span> <a href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a> <span>by </span> <a href="https://stackoverflow.com/legal/terms-of-service#licensing">Stack Overflow Inc.</a>
   </div>
  </div>
 </body>
</html>