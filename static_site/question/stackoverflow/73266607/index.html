<!doctype html>
<html lang="en">
 <head>
  <meta charset="UTF-8">
  <title>how to merge matching values of column in jQuery datatables excelHtml5</title>
  <link rel="stylesheet" type="text/css" href="/css/base.css">
  <script type="text/x-mathjax-config">
            MathJax.Hub.Config({"HTML-CSS": { preferredFont: "TeX", availableFonts: ["STIX","TeX"], linebreaks: { automatic:true }, EqnChunk: (MathJax.Hub.Browser.isMobile ? 10 : 50) },
            tex2jax: { inlineMath: [ ["$", "$"], ["\\\\(","\\\\)"] ], displayMath: [ ["$$","$$"], ["\\[", "\\]"] ], processEscapes: true, ignoreClass: "tex2jax_ignore|dno" },
            TeX: {
            extensions: ["begingroup.js"],
            noUndefined: { attributes: { mathcolor: "red", mathbackground: "#FFEEEE", mathsize: "90%" } },
            Macros: { href: "{}" }
            },
            messageStyle: "none",
            styles: { ".MathJax_Display, .MathJax_Preview, .MathJax_Preview > *": { "background": "inherit" } },
            SEEditor: "mathjaxEditing"
            });
        </script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_HTML-full"></script>
 </head>
 <body>
  <div class="question">
   <a href="/questions">All Questions</a>
   <h2>how to merge matching values of column in jQuery datatables excelHtml5</h2>
   <div class="container-metadata">
    <div>
     <span>Score: </span> <span>3</span>
    </div>
    <div>
     <span>Asker: </span> <span>gopal</span>
    </div>
    <div>
     <span>Asked: </span> <span>7 Aug 2022 at 10:17</span>
    </div>
    <div>
     <a href="https://stackoverflow.com/questions/73266607/how-to-merge-matching-values-of-column-in-jquery-datatables-excelhtml5">source</a>
    </div>
   </div>
   <div>
    <p>when i export excel from my datatable iam not able to merge col value. since the values of column <strong>B</strong> named <strong>Category</strong>. the duplicate values needed to be merged . i'am new to programming any help appreciated</p>
    <p>this my my <a href="https://jsfiddle.net/t1j6rzg8/2/" rel="nofollow noreferrer">jsfiddle</a></p>
    <p>this my code</p>
    <pre><code>&lt;table id="example1" class="table table-sm cell-border compact stripe table-bordered table-hover dataTable dtr-inline"
    cellspacing="0" width="100%" aria-describedby="example1_info"&gt;


    &lt;thead&gt;
        &lt;tr&gt;
            &lt;th class="d-none sorting_disabled" rowspan="1" colspan="1"&gt;Date&lt;/th&gt;
            &lt;th class="sorting_disabled" rowspan="1" colspan="1"&gt;Category&lt;/th&gt;
            &lt;th class="sorting_disabled" rowspan="1" colspan="1"&gt;Item Name&lt;/th&gt;
            &lt;th class="sorting_disabled" rowspan="1" colspan="1"&gt;Price&lt;/th&gt;
            &lt;th class="sorting_disabled" rowspan="1" colspan="1"&gt;Opening&lt;/th&gt;
            &lt;th class="sorting_disabled" rowspan="1" colspan="1"&gt;Recived&lt;/th&gt;
            &lt;th class="sorting_disabled" rowspan="1" colspan="1"&gt;Total&lt;/th&gt;
            &lt;th class="sorting_disabled" rowspan="1" colspan="1"&gt;Closing&lt;/th&gt;
            &lt;th class="sorting_disabled" rowspan="1" colspan="1"&gt;Sales&lt;/th&gt;
            &lt;th class="sorting_disabled" rowspan="1" colspan="1"&gt;Total&lt;/th&gt;
        &lt;/tr&gt;
    &lt;/thead&gt;

    &lt;tbody&gt;

        &lt;tr data-row-id="1761" class="even"&gt;
            &lt;td class="editable-col d-none" col-index="0" oldval="2022-08-07"&gt;2022-08-07&lt;/td&gt;
            &lt;th class="editable-col dtr-control" col-index="1" oldval="Brandy" tabindex="0"&gt;Brandy&lt;/th&gt;
            &lt;td class="editable-col" col-index="2" oldval="Golden Touch Brandy 180ml"&gt;Golden Touch Brandy 180ml&lt;/td&gt;
            &lt;td class="editable-col" col-index="2" oldval="250.00"&gt;250.00&lt;/td&gt;
            &lt;td class="editable-col" col-index="3" oldval="9.00"&gt;9.00&lt;/td&gt;
            &lt;td class="editable-col" col-index="4" oldval=""&gt;&lt;/td&gt;
            &lt;td class="editable-col" col-index="5" oldval="9"&gt;9&lt;/td&gt;
            &lt;td class="editable-col" col-index="6" oldval="9.00"&gt;9.00&lt;/td&gt;
            &lt;td class="editable-col" col-index="7" oldval="0"&gt;0&lt;/td&gt;
            &lt;td class="editable-col" col-index="8" oldval="0"&gt;0&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr data-row-id="1763" class="odd"&gt;
            &lt;td class="editable-col d-none" col-index="0" oldval="2022-08-07"&gt;2022-08-07&lt;/td&gt;
            &lt;th class="editable-col dtr-control" col-index="1" oldval="Brandy" tabindex="0"&gt;Brandy&lt;/th&gt;
            &lt;td class="editable-col" col-index="2" oldval="Golden Touch Brandy 750ml"&gt;Golden Touch Brandy 750ml&lt;/td&gt;
            &lt;td class="editable-col" col-index="2" oldval="1000.00"&gt;1000.00&lt;/td&gt;
            &lt;td class="editable-col" col-index="3" oldval="3.00"&gt;3.00&lt;/td&gt;
            &lt;td class="editable-col" col-index="4" oldval=""&gt;&lt;/td&gt;
            &lt;td class="editable-col" col-index="5" oldval="3"&gt;3&lt;/td&gt;
            &lt;td class="editable-col" col-index="6" oldval="3.00"&gt;3.00&lt;/td&gt;
            &lt;td class="editable-col" col-index="7" oldval="0"&gt;0&lt;/td&gt;
            &lt;td class="editable-col" col-index="8" oldval="0"&gt;0&lt;/td&gt;
        &lt;/tr&gt;
    
        &lt;tr data-row-id="1948" class="odd"&gt;
            &lt;td class="editable-col d-none" col-index="0" oldval="2022-08-07"&gt;2022-08-07&lt;/td&gt;
            &lt;th class="editable-col dtr-control" col-index="1" oldval="Brandy" tabindex="0"&gt;Brandy&lt;/th&gt;
            &lt;td class="editable-col" col-index="2" oldval="Whytehall Brandy 180ml"&gt;Whytehall Brandy 180ml&lt;/td&gt;
            &lt;td class="editable-col" col-index="2" oldval="250.00"&gt;250.00&lt;/td&gt;
            &lt;td class="editable-col" col-index="3" oldval="18.00"&gt;18.00&lt;/td&gt;
            &lt;td class="editable-col" col-index="4" oldval=""&gt;&lt;/td&gt;
            &lt;td class="editable-col" col-index="5" oldval="18"&gt;18&lt;/td&gt;
            &lt;td class="editable-col" col-index="6" oldval="18.00"&gt;18.00&lt;/td&gt;
            &lt;td class="editable-col" col-index="7" oldval="0"&gt;0&lt;/td&gt;
            &lt;td class="editable-col" col-index="8" oldval="0"&gt;0&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr data-row-id="1949" class="even"&gt;
            &lt;td class="editable-col d-none" col-index="0" oldval="2022-08-07"&gt;2022-08-07&lt;/td&gt;
            &lt;th class="editable-col dtr-control" col-index="1" oldval="Brandy" tabindex="0"&gt;Brandy&lt;/th&gt;
            &lt;td class="editable-col" col-index="2" oldval="Whytehall Brandy 750ml"&gt;Whytehall Brandy 750ml&lt;/td&gt;
            &lt;td class="editable-col" col-index="2" oldval="1000.00"&gt;1000.00&lt;/td&gt;
            &lt;td class="editable-col" col-index="3" oldval="4.00"&gt;4.00&lt;/td&gt;
            &lt;td class="editable-col" col-index="4" oldval=""&gt;&lt;/td&gt;
            &lt;td class="editable-col" col-index="5" oldval="4"&gt;4&lt;/td&gt;
            &lt;td class="editable-col" col-index="6" oldval="4.00"&gt;4.00&lt;/td&gt;
            &lt;td class="editable-col" col-index="7" oldval="0"&gt;0&lt;/td&gt;
            &lt;td class="editable-col" col-index="8" oldval="0"&gt;0&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr data-row-id="1992" class="odd"&gt;
            &lt;td class="editable-col d-none" col-index="0" oldval="2022-08-07"&gt;2022-08-07&lt;/td&gt;
            &lt;th class="editable-col dtr-control" col-index="1" oldval="Brandy" tabindex="0"&gt;Brandy&lt;/th&gt;
            &lt;td class="editable-col" col-index="2" oldval="Roulette Brandy 750ml"&gt;Roulette Brandy 750ml&lt;/td&gt;
            &lt;td class="editable-col" col-index="2" oldval="2230.00"&gt;2230.00&lt;/td&gt;
            &lt;td class="editable-col" col-index="3" oldval="1.00"&gt;1.00&lt;/td&gt;
            &lt;td class="editable-col" col-index="4" oldval=""&gt;&lt;/td&gt;
            &lt;td class="editable-col" col-index="5" oldval="1"&gt;1&lt;/td&gt;
            &lt;td class="editable-col" col-index="6" oldval="1.00"&gt;1.00&lt;/td&gt;
            &lt;td class="editable-col" col-index="7" oldval="0"&gt;0&lt;/td&gt;
            &lt;td class="editable-col" col-index="8" oldval="0"&gt;0&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr data-row-id="2048" class="even"&gt;
            &lt;td class="editable-col d-none" col-index="0" oldval="2022-08-07"&gt;2022-08-07&lt;/td&gt;
            &lt;th class="editable-col dtr-control" col-index="1" oldval="Brandy" tabindex="0"&gt;Brandy&lt;/th&gt;
            &lt;td class="editable-col" col-index="2" oldval="Bejois VSOP 375ML"&gt;Bejois VSOP 375ML&lt;/td&gt;
            &lt;td class="editable-col" col-index="2" oldval="200.00"&gt;200.00&lt;/td&gt;
            &lt;td class="editable-col" col-index="3" oldval="20.00"&gt;20.00&lt;/td&gt;
            &lt;td class="editable-col" col-index="4" oldval=""&gt;&lt;/td&gt;
            &lt;td class="editable-col" col-index="5" oldval="20"&gt;20&lt;/td&gt;
            &lt;td class="editable-col" col-index="6" oldval="20.00"&gt;20.00&lt;/td&gt;
            &lt;td class="editable-col" col-index="7" oldval="0"&gt;0&lt;/td&gt;
            &lt;td class="editable-col" col-index="8" oldval="0"&gt;0&lt;/td&gt;
        &lt;/tr&gt;
  
    &lt;/tbody&gt;


    &lt;tfoot&gt;

        &lt;tr&gt;
            &lt;th class="d-none" rowspan="1" colspan="1"&gt;0&lt;/th&gt;
            &lt;th rowspan="1" colspan="1"&gt;&lt;/th&gt;
            &lt;th rowspan="1" colspan="1"&gt;&lt;/th&gt;
            &lt;th rowspan="1" colspan="1"&gt;&lt;/th&gt;
            &lt;th rowspan="1" colspan="1"&gt; 1900&lt;/th&gt;
            &lt;th rowspan="1" colspan="1"&gt; 9&lt;/th&gt;
            &lt;th rowspan="1" colspan="1"&gt; 1909&lt;/th&gt;
            &lt;th rowspan="1" colspan="1"&gt; 1909&lt;/th&gt;
            &lt;th rowspan="1" colspan="1"&gt; 0&lt;/th&gt;
            &lt;th rowspan="1" colspan="1"&gt; 0&lt;/th&gt;
        &lt;/tr&gt;
    &lt;/tfoot&gt;


 
&lt;/table&gt;
</code></pre>
    <p>my javascript</p>
    <pre><code> $(document).ready(function () {

        document.title = 'shop';
        $('#example1').DataTable({
            "processing": true,
            "dom": 'Bfrtip',
            "lengthChange": false,
            "searching": false,
            "info": true,
            "autoWidth": false,
            "responsive": true,
            "retrieve": true,
            "paging": false,
            "lengthMenu": [
                [-1],
                ["All"]
            ],
            "bSort": false,
            "bLengthChange": false,

            "buttons": ["copy", {
                    extend: 'excelHtml5',
                    footer: true,
                    text: 'Save as Excel',
                    pageSize: 'A4',
                      customize: function (xlsx) {
                        var sheet = xlsx.xl.worksheets['sheet1.xml'];
                        $('c[r=C1] t', sheet).text('Sudha Wines');
                        $('row:first c', sheet).attr('s', '32');

                        var col = $('col', sheet);
                        $(col[0]).attr('width', 8);
                        $(col[1]).attr('width', 24);
                        $(col[2]).attr('width', 9);
                        $(col[3]).attr('width', 8);
                        $(col[4]).attr('width', 7);
                        $(col[5]).attr('width', 8);
                        $('row* ', sheet).each(function (index) {
                            if (index &gt; 0) {
                                $(this).attr('ht', 26);
                                $(this).attr('customHeight', 1);
                            }
                        });






                    },
                    
                  
                }
            ],


        });
    });
</code></pre>
    <p>output i'am getting in MS excel <a href="https://i.stack.imgur.com/KRsXM.png" rel="nofollow noreferrer"><img src="/question/stackoverflow/73266607/KRsXM.png" alt="enter image description here"></a></p>
    <p>Desired output i want is</p>
    <p><a href="https://i.stack.imgur.com/c1thQ.png" rel="nofollow noreferrer"><img src="/question/stackoverflow/73266607/c1thQ.png" alt="enter image description here"></a></p>
   </div>
   <div class="tags">
    <span class="tag">javascript</span><span class="tag">html</span><span class="tag">jquery</span><span class="tag">datatables</span>
   </div>
   <hr>
   <div class="comment">
    <table>
    </table>
   </div>
   <br>
   <div>
    <h2 id="answer_1"><span>Answer 1</span></h2>
    <div class="container-metadata">
     <div>
      <span>Score: </span> <span>1</span>
     </div>
     <div>
      <span>Answerer: </span> <span>andrewJames</span>
     </div>
     <div>
      <span> Answered: </span> <span>7 Aug 2022 at 18:17</span>
     </div>
    </div>
    <div>
     <p>The OpenXML spreadsheet format used by Excel specifies merged ranges as follows:</p>
     <pre class="lang-xml prettyprint-override"><code>&lt;mergeCells  count="2"&gt;
    &lt;mergeCell ref="B2:B5"/&gt;
    &lt;mergeCell ref="B6:B7"/&gt;
&lt;/mergeCells&gt;
</code></pre>
     <p>The above represents 2 merged ranges in a worksheet.</p>
     <p>We therefore need to add logic to scan the data in your "Category" column, to determine what ranges we need to create. Once we have these ranges we can build the above Excel XML fragment and insert it into the worksheet, during the export process.</p>
     <p>You already have your <code>customize: function (xlsx) { ... }</code>, so we can add our logic there:</p>
     <pre class="lang-js prettyprint-override"><code>var ranges = buildRanges(sheet);
                        
// build the HTML string:
var mergeCellsHtml = '&lt;mergeCells count="' + ranges.length + '"&gt;';
ranges.forEach(function(range) {
    mergeCellsHtml = mergeCellsHtml + '&lt;mergeCell ref="' + range + '"/&gt;';
})
mergeCellsHtml = mergeCellsHtml + '&lt;/mergeCells&gt;';

$( 'sheetData', sheet ).after( mergeCellsHtml );
// don't know why, but Excel auto-adds an extra mergeCells tag, so remove it:
$( 'mergeCells', sheet ).last().remove();
</code></pre>
     <p>The work of building the ranges is in the <code>buildRanges(sheet)</code> function. I expect this code could be streamlined/improved, but it shows the overall approach:</p>
     <pre class="lang-js prettyprint-override"><code>function buildRanges(sheet) {

  let prevCat = ''; // previous category
  let currCat = ''; // current category
  let currCellRef = ''; // current cell reference
  let rows = $('row', sheet);
  let startRange = '';
  let endRange = '';
  let ranges = [];

  rows.each(function (i) {
    if (i &gt; 0 &amp;&amp; i &lt; rows.length) { // skip first (headings) row
      let cols = $('c', $(this));
      cols.each(function (j) {
        if (j == 1) { // the "Category" column
          currCat = $(this).text(); // current row's category
          currCellRef = $(this).attr('r'); // e.g. "B3"
          if (currCat !== prevCat) {
            if (i == 1) {
              // start of first range
              startRange = currCellRef;
              endRange = currCellRef;
              prevCat = currCat;
            } else {
              // end of previous range
              if (endRange !== startRange) {
                // capture the range:
                ranges.push( startRange + ':' + endRange );
              }
               // start of a new range
              startRange = currCellRef;
              endRange = currCellRef;
              prevCat = currCat;
            }
          } else {
            // extend the current range end:
            endRange = currCellRef;
          }
          //console.log( $(this).attr('r') );
        }
      });
      if (i == rows.length -1 &amp;&amp; endRange !== startRange) {
        // capture the final range:
        ranges.push( startRange + ':' + endRange );
      }
    }
  });
  return ranges;
}
</code></pre>
     <p>This function scans your categories column looking for when the value in that column changes.</p>
     <p>It assumes the values are already sorted/grouped, to support this.</p>
     <hr>
     <p><strong>One Important Note</strong></p>
     <p>I added the following line to your buttons logic:</p>
     <pre><code>title: '', // no title row in excel sheet
</code></pre>
     <p>This ensures that the spreadsheet does not already have any merged-cell ranges created. If you want this feature, then my logic would need to be adjusted, as there would already be a <code>&lt;mergeCells&gt;</code> tag in the spreadsheet (in the first row, containing the title).</p>
     <hr>
     <p>The end result looks something like this:</p>
     <p><a href="https://i.stack.imgur.com/izSRx.png" rel="nofollow noreferrer"><img src="/question/stackoverflow/73266607/izSRx.png" alt="enter image description here"></a></p>
     <p>Here are all the pieces in one demo (not sure if you can actually run the Excel download from within a Stack Snippet):</p>
     <p></p>
     <div class="snippet" data-lang="js" data-hide="false" data-console="true" data-babel="false">
      <div class="snippet-code">
       <pre class="snippet-code-js lang-js prettyprint-override"><code>  $(document).ready(function () {

        document.title = 'shop';
        $('#example1').DataTable({
            "processing": true,
            "dom": 'Bfrtip',
            "lengthChange": false,
            "searching": false,
            "info": true,
            "autoWidth": false,
            "responsive": true,
            "retrieve": true,
            "paging": false,
            "lengthMenu": [
                [-1],
                ["All"]
            ],
            "bSort": false,
            "bLengthChange": false,

            "buttons": ["copy", {
                    extend: 'excelHtml5',
                    footer: true,
                    text: 'Save as Excel',
                    title: '', // no title row in excel sheet
                    pageSize: 'A4',
                      customize: function (xlsx) {
                        var sheet = xlsx.xl.worksheets['sheet1.xml'];
                        
                        $('row:first c', sheet).attr('s', '32');

                        var col = $('col', sheet);
                        $(col[0]).attr('width', 8);
                        $(col[1]).attr('width', 24);
                        $(col[2]).attr('width', 9);
                        $(col[3]).attr('width', 8);
                        $(col[4]).attr('width', 7);
                        $(col[5]).attr('width', 8);
                        $('row* ', sheet).each(function (index) {
                            if (index &gt; 0) {
                                $(this).attr('ht', 26);
                                $(this).attr('customHeight', 1);
                            }
                        });

                        var ranges = buildRanges(sheet);
                        
                        // build the HTML string:
                        var mergeCellsHtml = '&lt;mergeCells count="' + ranges.length + '"&gt;';
                        ranges.forEach(function(range) {
                            mergeCellsHtml = mergeCellsHtml + '&lt;mergeCell ref="' + range + '"/&gt;';
                        })
                        mergeCellsHtml = mergeCellsHtml + '&lt;/mergeCells&gt;';

                        $( 'sheetData', sheet ).after( mergeCellsHtml );
                        // don't know why, but Excel auto-adds an extra mergeCells tag, so remove it:
                        $( 'mergeCells', sheet ).last().remove(); 



                    }
                    
                  
                }
            ]


        });
    });
    
function buildRanges(sheet) {

  let prevCat = ''; // previous category
  let currCat = ''; // current category
  let currCellRef = ''; // current cell reference
  let rows = $('row', sheet);
  let startRange = '';
  let endRange = '';
  let ranges = [];

  rows.each(function (i) {
    if (i &gt; 0 &amp;&amp; i &lt; rows.length) { // skip first (headings) row
      let cols = $('c', $(this));
      cols.each(function (j) {
        if (j == 1) { // the "Category" column
          currCat = $(this).text(); // current row's category
          currCellRef = $(this).attr('r'); // e.g. "B3"
          if (currCat !== prevCat) {
            if (i == 1) {
              // start of first range
              startRange = currCellRef;
              endRange = currCellRef;
              prevCat = currCat;
            } else {
              // end of previous range
              if (endRange !== startRange) {
                // capture the range:
                ranges.push( startRange + ':' + endRange );
              }
               // start of a new range
              startRange = currCellRef;
              endRange = currCellRef;
              prevCat = currCat;
            }
          } else {
            // extend the current range end:
            endRange = currCellRef;
          }
          //console.log( $(this).attr('r') );
        }
      });
      if (i == rows.length -1 &amp;&amp; endRange !== startRange) {
        // capture the final range:
        ranges.push( startRange + ':' + endRange );
      }
    }
  });
  return ranges;
}</code></pre>
       <pre class="snippet-code-html lang-html prettyprint-override"><code>&lt;!doctype html&gt;
&lt;html&gt;
&lt;head&gt;
  &lt;meta charset="UTF-8"&gt;
  &lt;title&gt;Demo&lt;/title&gt;

  &lt;script type="text/javascript" src="https://code.jquery.com/jquery-3.3.1.min.js"&gt;&lt;/script&gt;
  &lt;script type="text/javascript" src="https://cdn.datatables.net/1.10.23/js/jquery.dataTables.min.js"&gt;&lt;/script&gt;
  &lt;link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.23/css/jquery.dataTables.min.css"/&gt;

  &lt;link rel="stylesheet" type="text/css" href="https://datatables.net/media/css/site-examples.css"&gt;

  &lt;link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/buttons/1.6.5/css/buttons.dataTables.min.css"/&gt; 
  &lt;script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jszip/2.5.0/jszip.min.js"&gt;&lt;/script&gt;
  &lt;script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.36/pdfmake.min.js"&gt;&lt;/script&gt;
  &lt;script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.36/vfs_fonts.js"&gt;&lt;/script&gt;
  &lt;script type="text/javascript" src="https://cdn.datatables.net/buttons/1.6.5/js/dataTables.buttons.min.js"&gt;&lt;/script&gt;
  &lt;script type="text/javascript" src="https://cdn.datatables.net/buttons/1.6.5/js/buttons.colVis.min.js"&gt;&lt;/script&gt;
  &lt;script type="text/javascript" src="https://cdn.datatables.net/buttons/1.6.5/js/buttons.flash.min.js"&gt;&lt;/script&gt;
  &lt;script type="text/javascript" src="https://cdn.datatables.net/buttons/1.6.5/js/buttons.html5.min.js"&gt;&lt;/script&gt;
  &lt;script type="text/javascript" src="https://cdn.datatables.net/buttons/1.6.5/js/buttons.print.min.js"&gt;&lt;/script&gt;

&lt;/head&gt;

&lt;body&gt;

&lt;div style="margin: 20px;"&gt;

    &lt;table id="example1" class="table table-sm cell-border compact stripe table-bordered table-hover dataTable dtr-inline"
    cellspacing="0" width="100%" aria-describedby="example1_info"&gt;


    &lt;thead&gt;
        &lt;tr&gt;
            &lt;th class="d-none sorting_disabled" rowspan="1" colspan="1"&gt;Date&lt;/th&gt;
            &lt;th class="sorting_disabled" rowspan="1" colspan="1"&gt;Category&lt;/th&gt;
            &lt;th class="sorting_disabled" rowspan="1" colspan="1"&gt;Item Name&lt;/th&gt;
            &lt;th class="sorting_disabled" rowspan="1" colspan="1"&gt;Price&lt;/th&gt;
            &lt;th class="sorting_disabled" rowspan="1" colspan="1"&gt;Opening&lt;/th&gt;
            &lt;th class="sorting_disabled" rowspan="1" colspan="1"&gt;Recived&lt;/th&gt;
            &lt;th class="sorting_disabled" rowspan="1" colspan="1"&gt;Total&lt;/th&gt;
            &lt;th class="sorting_disabled" rowspan="1" colspan="1"&gt;Closing&lt;/th&gt;
            &lt;th class="sorting_disabled" rowspan="1" colspan="1"&gt;Sales&lt;/th&gt;
            &lt;th class="sorting_disabled" rowspan="1" colspan="1"&gt;Total&lt;/th&gt;
        &lt;/tr&gt;
    &lt;/thead&gt;

    &lt;tbody&gt;

        &lt;tr data-row-id="1761" class="even"&gt;
            &lt;td class="editable-col d-none" col-index="0" oldval="2022-08-07"&gt;2022-08-07&lt;/td&gt;
            &lt;th class="editable-col dtr-control" col-index="1" oldval="Brandy" tabindex="0"&gt;Brandy&lt;/th&gt;
            &lt;td class="editable-col" col-index="2" oldval="Golden Touch Brandy 180ml"&gt;Golden Touch Brandy 180ml&lt;/td&gt;
            &lt;td class="editable-col" col-index="2" oldval="250.00"&gt;250.00&lt;/td&gt;
            &lt;td class="editable-col" col-index="3" oldval="9.00"&gt;9.00&lt;/td&gt;
            &lt;td class="editable-col" col-index="4" oldval=""&gt;&lt;/td&gt;
            &lt;td class="editable-col" col-index="5" oldval="9"&gt;9&lt;/td&gt;
            &lt;td class="editable-col" col-index="6" oldval="9.00"&gt;9.00&lt;/td&gt;
            &lt;td class="editable-col" col-index="7" oldval="0"&gt;0&lt;/td&gt;
            &lt;td class="editable-col" col-index="8" oldval="0"&gt;0&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr data-row-id="1763" class="odd"&gt;
            &lt;td class="editable-col d-none" col-index="0" oldval="2022-08-07"&gt;2022-08-07&lt;/td&gt;
            &lt;th class="editable-col dtr-control" col-index="1" oldval="Brandy" tabindex="0"&gt;Brandy&lt;/th&gt;
            &lt;td class="editable-col" col-index="2" oldval="Golden Touch Brandy 750ml"&gt;Golden Touch Brandy 750ml&lt;/td&gt;
            &lt;td class="editable-col" col-index="2" oldval="1000.00"&gt;1000.00&lt;/td&gt;
            &lt;td class="editable-col" col-index="3" oldval="3.00"&gt;3.00&lt;/td&gt;
            &lt;td class="editable-col" col-index="4" oldval=""&gt;&lt;/td&gt;
            &lt;td class="editable-col" col-index="5" oldval="3"&gt;3&lt;/td&gt;
            &lt;td class="editable-col" col-index="6" oldval="3.00"&gt;3.00&lt;/td&gt;
            &lt;td class="editable-col" col-index="7" oldval="0"&gt;0&lt;/td&gt;
            &lt;td class="editable-col" col-index="8" oldval="0"&gt;0&lt;/td&gt;
        &lt;/tr&gt;
    
        &lt;tr data-row-id="1948" class="odd"&gt;
            &lt;td class="editable-col d-none" col-index="0" oldval="2022-08-07"&gt;2022-08-07&lt;/td&gt;
            &lt;th class="editable-col dtr-control" col-index="1" oldval="Brandy" tabindex="0"&gt;Brandy&lt;/th&gt;
            &lt;td class="editable-col" col-index="2" oldval="Whytehall Brandy 180ml"&gt;Whytehall Brandy 180ml&lt;/td&gt;
            &lt;td class="editable-col" col-index="2" oldval="250.00"&gt;250.00&lt;/td&gt;
            &lt;td class="editable-col" col-index="3" oldval="18.00"&gt;18.00&lt;/td&gt;
            &lt;td class="editable-col" col-index="4" oldval=""&gt;&lt;/td&gt;
            &lt;td class="editable-col" col-index="5" oldval="18"&gt;18&lt;/td&gt;
            &lt;td class="editable-col" col-index="6" oldval="18.00"&gt;18.00&lt;/td&gt;
            &lt;td class="editable-col" col-index="7" oldval="0"&gt;0&lt;/td&gt;
            &lt;td class="editable-col" col-index="8" oldval="0"&gt;0&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr data-row-id="1949" class="even"&gt;
            &lt;td class="editable-col d-none" col-index="0" oldval="2022-08-07"&gt;2022-08-07&lt;/td&gt;
            &lt;th class="editable-col dtr-control" col-index="1" oldval="Brandy" tabindex="0"&gt;Brandy&lt;/th&gt;
            &lt;td class="editable-col" col-index="2" oldval="Whytehall Brandy 750ml"&gt;Whytehall Brandy 750ml&lt;/td&gt;
            &lt;td class="editable-col" col-index="2" oldval="1000.00"&gt;1000.00&lt;/td&gt;
            &lt;td class="editable-col" col-index="3" oldval="4.00"&gt;4.00&lt;/td&gt;
            &lt;td class="editable-col" col-index="4" oldval=""&gt;&lt;/td&gt;
            &lt;td class="editable-col" col-index="5" oldval="4"&gt;4&lt;/td&gt;
            &lt;td class="editable-col" col-index="6" oldval="4.00"&gt;4.00&lt;/td&gt;
            &lt;td class="editable-col" col-index="7" oldval="0"&gt;0&lt;/td&gt;
            &lt;td class="editable-col" col-index="8" oldval="0"&gt;0&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr data-row-id="1992" class="odd"&gt;
            &lt;td class="editable-col d-none" col-index="0" oldval="2022-08-07"&gt;2022-08-07&lt;/td&gt;
            &lt;th class="editable-col dtr-control" col-index="1" oldval="Brandy" tabindex="0"&gt;Port&lt;/th&gt;
            &lt;td class="editable-col" col-index="2" oldval="Roulette Brandy 750ml"&gt;Roulette Brandy 750ml&lt;/td&gt;
            &lt;td class="editable-col" col-index="2" oldval="2230.00"&gt;2230.00&lt;/td&gt;
            &lt;td class="editable-col" col-index="3" oldval="1.00"&gt;1.00&lt;/td&gt;
            &lt;td class="editable-col" col-index="4" oldval=""&gt;&lt;/td&gt;
            &lt;td class="editable-col" col-index="5" oldval="1"&gt;1&lt;/td&gt;
            &lt;td class="editable-col" col-index="6" oldval="1.00"&gt;1.00&lt;/td&gt;
            &lt;td class="editable-col" col-index="7" oldval="0"&gt;0&lt;/td&gt;
            &lt;td class="editable-col" col-index="8" oldval="0"&gt;0&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr data-row-id="2048" class="even"&gt;
            &lt;td class="editable-col d-none" col-index="0" oldval="2022-08-07"&gt;2022-08-07&lt;/td&gt;
            &lt;th class="editable-col dtr-control" col-index="1" oldval="Brandy" tabindex="0"&gt;Port&lt;/th&gt;
            &lt;td class="editable-col" col-index="2" oldval="Bejois VSOP 375ML"&gt;Bejois VSOP 375ML&lt;/td&gt;
            &lt;td class="editable-col" col-index="2" oldval="200.00"&gt;200.00&lt;/td&gt;
            &lt;td class="editable-col" col-index="3" oldval="20.00"&gt;20.00&lt;/td&gt;
            &lt;td class="editable-col" col-index="4" oldval=""&gt;&lt;/td&gt;
            &lt;td class="editable-col" col-index="5" oldval="20"&gt;20&lt;/td&gt;
            &lt;td class="editable-col" col-index="6" oldval="20.00"&gt;20.00&lt;/td&gt;
            &lt;td class="editable-col" col-index="7" oldval="0"&gt;0&lt;/td&gt;
            &lt;td class="editable-col" col-index="8" oldval="0"&gt;0&lt;/td&gt;
        &lt;/tr&gt;
  
    &lt;/tbody&gt;


    &lt;tfoot&gt;

        &lt;tr&gt;
            &lt;th class="d-none" rowspan="1" colspan="1"&gt;0&lt;/th&gt;
            &lt;th rowspan="1" colspan="1"&gt;&lt;/th&gt;
            &lt;th rowspan="1" colspan="1"&gt;&lt;/th&gt;
            &lt;th rowspan="1" colspan="1"&gt;&lt;/th&gt;
            &lt;th rowspan="1" colspan="1"&gt; 1900&lt;/th&gt;
            &lt;th rowspan="1" colspan="1"&gt; 9&lt;/th&gt;
            &lt;th rowspan="1" colspan="1"&gt; 1909&lt;/th&gt;
            &lt;th rowspan="1" colspan="1"&gt; 1909&lt;/th&gt;
            &lt;th rowspan="1" colspan="1"&gt; 0&lt;/th&gt;
            &lt;th rowspan="1" colspan="1"&gt; 0&lt;/th&gt;
        &lt;/tr&gt;
    &lt;/tfoot&gt;


 
&lt;/table&gt;

&lt;/div&gt;



&lt;/body&gt;
&lt;/html&gt;</code></pre>
      </div>
     </div>
     <p></p>
    </div>
    <hr>
    <div class="comment">
     <table>
      <tbody>
       <tr>
        <td></td>
        <td><span>do you have any solutions to his question also any help appreciated <a href="https://stackoverflow.com/q/73353748/18209690">stackoverflow.com/q/73353748/18209690</a></span> <span> - </span> <span class="display-name">gopal</span> <span> </span> <span class="date">14 Aug 2022 at 17:41</span></td>
       </tr>
       <tr>
        <td></td>
        <td><span>sorry i have a questiion about this ,, can i merge cell only the tfoot tags ?? i mean merge rows. like the example above can you mergecell the A8:D8 ?? thanks</span> <span> - </span> <span class="display-name">Vendetta</span> <span> </span> <span class="date">8 Jun 2023 at 08:26</span></td>
       </tr>
       <tr>
        <td></td>
        <td><span>this can be manually merge by edit the <code>mergeCellsHtml = mergeCellsHtml + '&lt;mergeCell ref="A8:D8"/&gt;'</code> right ?? but how about merge it automaticly without change the <code>&lt;mergeCell ref="A8:D8"/&gt;</code> ??</span> <span> - </span> <span class="display-name">Vendetta</span> <span> </span> <span class="date">8 Jun 2023 at 08:32</span></td>
       </tr>
       <tr>
        <td></td>
        <td><span>@andrewJames - i just made the question here <a href="https://stackoverflow.com/questions/76436973/how-to-merge-cells-only-the-tfoot-tag-in-export-datatables-excel">link</a></span> <span> - </span> <span class="display-name">Vendetta</span> <span> </span> <span class="date">9 Jun 2023 at 03:15</span></td>
       </tr>
      </tbody>
     </table>
    </div>
   </div>
   <br>
   <div>
    <span>License: </span> <a href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a> <span>by </span> <a href="https://stackoverflow.com/legal/terms-of-service#licensing">Stack Overflow Inc.</a>
   </div>
  </div>
 </body>
</html>