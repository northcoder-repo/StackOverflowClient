<!doctype html>
<html lang="en">
 <head>
  <meta charset="UTF-8">
  <title>while Parsing TXT to CSV using JAVA long numbers are getting converted to exponential</title>
  <link rel="stylesheet" type="text/css" href="/css/base.css">
  <script type="text/x-mathjax-config">
            MathJax.Hub.Config({"HTML-CSS": { preferredFont: "TeX", availableFonts: ["STIX","TeX"], linebreaks: { automatic:true }, EqnChunk: (MathJax.Hub.Browser.isMobile ? 10 : 50) },
            tex2jax: { inlineMath: [ ["$", "$"], ["\\\\(","\\\\)"] ], displayMath: [ ["$$","$$"], ["\\[", "\\]"] ], processEscapes: true, ignoreClass: "tex2jax_ignore|dno" },
            TeX: {
            extensions: ["begingroup.js"],
            noUndefined: { attributes: { mathcolor: "red", mathbackground: "#FFEEEE", mathsize: "90%" } },
            Macros: { href: "{}" }
            },
            messageStyle: "none",
            styles: { ".MathJax_Display, .MathJax_Preview, .MathJax_Preview > *": { "background": "inherit" } },
            SEEditor: "mathjaxEditing"
            });
        </script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_HTML-full"></script>
 </head>
 <body>
  <div class="question">
   <a href="/questions">All Questions</a>
   <h2>while Parsing TXT to CSV using JAVA long numbers are getting converted to exponential</h2>
   <div class="container-metadata">
    <div>
     <span>Score: </span> <span>0</span>
    </div>
    <div>
     <span>Asker: </span> <span>bitan</span>
    </div>
    <div>
     <span>Asked: </span> <span>23 Dec 2020 at 21:25</span>
    </div>
    <div>
     <a href="https://stackoverflow.com/questions/65431124/while-parsing-txt-to-csv-using-java-long-numbers-are-getting-converted-to-expone">source</a>
    </div>
   </div>
   <div>
    <p>I have big txt file which needs to converted to CSV format using JAVA ,</p>
    <p>I am parsing the file but file is having some long nos in a column which is getting converted to exponential . like :89148000006119921953 -&gt;8.9148E I need to parse the txt to csv in such a way so what csv opens with excel doesn't not convert to exponentials values</p>
    <p>Please find the below code :</p>
    <pre><code>public static String converter(String filename) throws Exception {
        FileWriter writer = null;
        if (filename.toString().endsWith("TXT")) {
            File file = new File("C:\\convertertool\\inputFiles\\" + filename + "");
            Scanner scan = new Scanner(file);
            filename = filename.replace("TXT", "CSV");
            File file2 = new File("C:\\convertertool\\ParsedFiles\\" + filename + "");
            file.createNewFile();
            writer = new FileWriter(file2);

            while (scan.hasNext()) {
                String csv = scan.nextLine().replace("|", ",");
                System.out.println(csv);
                writer.append(csv);
                writer.append("\n");
                writer.flush();
            }
        }
        return filename;

    }
</code></pre>
   </div>
   <div class="tags">
    <span class="tag">java</span><span class="tag">opencsv</span>
   </div>
   <hr>
   <div class="comment">
    <table>
     <tbody>
      <tr>
       <td></td>
       <td><span>I think you are seeing that because you are opening the csv in excel which is default in windows. Open your csv in text editor and it should have the correct numbers. Your code looks ok to me.</span> <span> - </span> <span class="display-name">A Paul</span> <span> </span> <span class="date">23 Dec 2020 at 21:45</span></td>
      </tr>
      <tr>
       <td>1</td>
       <td><span>Small note: You have tagged your question with the <a href="https://stackoverflow.com/tags/opencsv/info"><code>opencsv</code> tag</a>, but your code does not appear to be using that (or any) CSV parsing library. I'd recommend using a parsing library - even for straightforward data. It can help you to avoid CSV parsing/formatting surprises.</span> <span> - </span> <span class="display-name">andrewJames</span> <span> </span> <span class="date">23 Dec 2020 at 21:52</span></td>
      </tr>
      <tr>
       <td></td>
       <td><span>Yes but the ask is the file has to be opened in excel and the long numbers should not get converted to exponential ..is there any way we can handle it??</span> <span> - </span> <span class="display-name">bitan</span> <span> </span> <span class="date">23 Dec 2020 at 21:53</span></td>
      </tr>
      <tr>
       <td></td>
       <td><span>@andrewjames can you please share if you have any thing</span> <span> - </span> <span class="display-name">bitan</span> <span> </span> <span class="date">23 Dec 2020 at 21:54</span></td>
      </tr>
      <tr>
       <td></td>
       <td><span>Regarding the scientific notation problem: The Excel factor changes the question! <a href="https://superuser.com/questions/969017/how-to-format-a-20-digit-number-as-i-want-in-excel">How to format a 20 digit number as I want in excel?</a>. Regarding CSV parsers - take a look at the opencsv link for one example.</span> <span> - </span> <span class="display-name">andrewJames</span> <span> </span> <span class="date">23 Dec 2020 at 21:57</span></td>
      </tr>
      <tr>
       <td></td>
       <td><span>@bitan if you want to open in excel then there is 1 things you can do , open the csv file(after its created by the java code) in excel and then select the column and click "Format Cell" and then select is as number or special. And it will show like the way you want. I do not think there is any other way that I know.</span> <span> - </span> <span class="display-name">A Paul</span> <span> </span> <span class="date">23 Dec 2020 at 22:04</span></td>
      </tr>
     </tbody>
    </table>
   </div>
   <br>
   <div>
    <h2 id="answer_1"><span>Answer 1</span> <span class="arrow"> <a href="#answer_2">↓</a> </span></h2>
    <div class="container-metadata">
     <div>
      <span>Score: </span> <span>0</span>
     </div>
     <div>
      <span>Answerer: </span> <span>Eden Moshe</span>
     </div>
     <div>
      <span> Answered: </span> <span>23 Dec 2020 at 22:30</span>
     </div>
    </div>
    <div>
     <pre><code>Double.parseDouble("891413E")//or BigDecimal.parse...
</code></pre>
     <p>Can help you</p>
    </div>
    <hr>
    <div class="comment">
     <table>
      <tbody>
       <tr>
        <td></td>
        <td><span>I need to parse txt to csv in such a way that scientific notation surprise should not come.</span> <span> - </span> <span class="display-name">bitan</span> <span> </span> <span class="date">23 Dec 2020 at 22:44</span></td>
       </tr>
      </tbody>
     </table>
    </div>
   </div>
   <div>
    <h2 id="answer_2"><span>Answer 2</span> <span class="arrow"> <a href="#answer_1">↑</a> </span></h2>
    <div class="container-metadata">
     <div>
      <span>Score: </span> <span>-1</span>
     </div>
     <div>
      <span>Answerer: </span> <span>andrewJames</span>
     </div>
     <div>
      <span> Answered: </span> <span>24 Dec 2020 at 02:41</span>
     </div>
    </div>
    <div>
     <p>The assumptions are:</p>
     <p>(1) You want to open the CSV file (e.g. <code>test.csv</code>) in Excel by double-clicking on the file, so that the data is displayed as a sequence of digits (instead of using scientific notation).</p>
     <p>(2) You do not want to perform any manual formatting on the Excel file, after it has been opened (so, for example you do not want to have to change the Excel cell formatting).</p>
     <p>(3) You do not want to use the Excel manual import wizard.</p>
     <p>The only way I know of doing this is to write an Excel formula to the CSV file, instead of writing the actual, unadulterated numeric value. You can use any Excel formula which converts the number to a string.</p>
     <p>For example, if the numeric value is this:</p>
     <pre><code>89148000006119921953
</code></pre>
     <p>then the CSV file needs to contain the following (I added <code>field one</code> just for this demo):</p>
     <pre><code>field one,"=TEXT(89148000006119921953,""#"")"
</code></pre>
     <p>You can try this for yourself by pasting the above into a <code>test.csv</code> file, and seeing what happens when you double-click on it.</p>
     <p>The result in Excel is this:</p>
     <p><a href="https://i.stack.imgur.com/u0UpE.png" rel="nofollow noreferrer"><img src="https://i.stack.imgur.com/u0UpE.png" alt="enter image description here"></a></p>
     <p>In this case the Excel formula (if created directly in Excel) would be this:</p>
     <pre><code>=TEXT(1234567890123450000,"#")
</code></pre>
     <p>So in the CSV file, we have to surround the field in double quotes, and we have to escape the double quotes inside the formula by doubling them.</p>
     <p>There are some disadvantages to doing this:</p>
     <p>(a) The text file no longer contains the pure, unchanged data. It contains an Excel formula instead. So it is more-or-less useless outside of Excel.</p>
     <p>(b) The value in Excel is a text formula not a number (so you can't perform arithmetic on it).</p>
     <p>(c) The Excel column widths will not auto-resize, so if there is any data in cell C1, then cell B1's display will be truncated (but the full text will still be there).</p>
     <p>(d) Now you almost certainly do need a proper Java CSV parsing library to make sure you generate valid CSV data.</p>
     <p>Final thought: If the end result needs to be viewed in Excel (and only in Excel), then maybe you should generate an actual Excel file (e.g. using Apache POI) instead of generating a CSV file.</p>
    </div>
    <hr>
    <div class="comment">
     <table>
     </table>
    </div>
   </div>
   <br>
   <div>
    <span>License: </span> <a href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a> <span>by </span> <a href="https://stackoverflow.com/legal/terms-of-service#licensing">Stack Overflow Inc.</a>
   </div>
  </div>
 </body>
</html>