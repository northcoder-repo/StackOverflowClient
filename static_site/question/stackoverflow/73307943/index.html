<!doctype html>
<html lang="en">
 <head>
  <meta charset="UTF-8">
  <title>Don't print all columns with datatables</title>
  <link rel="stylesheet" type="text/css" href="/css/base.css">
  <script type="text/x-mathjax-config">
            MathJax.Hub.Config({"HTML-CSS": { preferredFont: "TeX", availableFonts: ["STIX","TeX"], linebreaks: { automatic:true }, EqnChunk: (MathJax.Hub.Browser.isMobile ? 10 : 50) },
            tex2jax: { inlineMath: [ ["$", "$"], ["\\\\(","\\\\)"] ], displayMath: [ ["$$","$$"], ["\\[", "\\]"] ], processEscapes: true, ignoreClass: "tex2jax_ignore|dno" },
            TeX: {
            extensions: ["begingroup.js"],
            noUndefined: { attributes: { mathcolor: "red", mathbackground: "#FFEEEE", mathsize: "90%" } },
            Macros: { href: "{}" }
            },
            messageStyle: "none",
            styles: { ".MathJax_Display, .MathJax_Preview, .MathJax_Preview > *": { "background": "inherit" } },
            SEEditor: "mathjaxEditing"
            });
        </script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_HTML-full"></script>
 </head>
 <body>
  <div class="question">
   <a href="/questions">All Questions</a>
   <h2>Don't print all columns with datatables</h2>
   <div class="container-metadata">
    <div>
     <span>Score: </span> <span>0</span>
    </div>
    <div>
     <span>Asker: </span> <span>Bruno</span>
    </div>
    <div>
     <span>Asked: </span> <span>10 Aug 2022 at 14:19</span>
    </div>
    <div>
     <a href="https://stackoverflow.com/questions/73307943/dont-print-all-columns-with-datatables">source</a>
    </div>
   </div>
   <div>
    <p>I have the following code to generate the table:</p>
    <p></p>
    <div class="snippet" data-lang="js" data-hide="false" data-console="true" data-babel="false">
     <div class="snippet-code">
      <pre class="snippet-code-js lang-js prettyprint-override"><code>$(function () { 
  $('.cons-assid').on("click", function() {
    $("#consultassid tbody").empty();
      var linha = ``; 

        $('.consultassid &gt; tbody &gt; tr').remove();
        
        linha += `&lt;tr"&gt;
                      &lt;td class="text-center text-muted" style="display:none;"&gt; 08&lt;/td&gt;
                      &lt;td class="text-center text-muted" style="display:none;"&gt; 09&lt;/td&gt;
                      &lt;td class="text-center text-muted"&gt; Teste&lt;/td&gt;
                      &lt;td class="text-center text-muted"&gt; Teste1&lt;/td&gt;
                      &lt;td class="text-center text-muted"&gt; Teste2&lt;/td&gt;
                      &lt;td class="text-center text-muted"&gt; Teste3&lt;/td&gt;
                      &lt;td class="text-center text-muted"&gt; Teste4&lt;/td&gt;
                      &lt;td class="text-center text-muted"&gt; Teste5&lt;/td&gt;
                      &lt;td class="text-center text-muted"&gt; Teste6&lt;/td&gt;
                    &lt;/tr&gt;`;
                    
      $("#consultassid tbody").html(linha);

      $('.consultassid').dataTable({ 
        dom: 'Bflrtip',
        "pagingType": "full_numbers", 
        "iDisplayLength": 10,                          
        "oLanguage": {
        "sProcessing": "Aguarde enquanto os dados são carregados ...",
        "sLengthMenu": "Mostrar _MENU_ registos por página",
        "sZeroRecords": "Nenhum registo correspondente ao criterio encontrado",
        "sInfoEmpty": "Exibindo 0 a 0 de 0 registos",
        "sInfo": "Exibindo de _START_ a _END_ de _TOTAL_ registos",
        "sInfoFiltered": "",
        "sSearch": "&lt;span class='glyphicon glyphicon-search'&gt;&lt;/span&gt;",
        "oPaginate": {
          "sFirst":    "&lt;i class='fa fa-fast-backward' aria-hidden='true'&gt;&lt;/i&gt;",
          "sPrevious": "&lt;i class='fa fa-backward' aria-hidden='true'&gt;&lt;/i&gt;&lt;/span&gt;",
          "sNext":     "&lt;i class='fa fa-forward' aria-hidden='true'&gt;&lt;/i&gt;",
          "sLast":     "&lt;i class='fa fa-fast-forward' aria-hidden='true'&gt;&lt;/i&gt;"
          }
        },
        buttons: [
          {
            extend: 'excel',
                    text: 'excel',
                    title: 'Registo de Marcações',
      
          },
          {
              extend: 'pdf',
                      text: 'pdf',
                      title: 'Registo de Marcações',
                      
          },
          {
              extend: 'print',
                      text: 'print',
                      title: 'Registo de Marcações',
                      customize: function ( win ) {
                          $(win.document.body)
                              .css( 'font-size', '12pt' );
        
                          $(win.document.body).find( 'table' )
                              .addClass( 'compact' )
                              .css( 'font-size', 'inherit' );
                      }
          }
        ]
      });   

    });
  });
  
  $(function() {
    $(".btn-show").click(function(e) {
      e.preventDefault();
      el = $(this).data('element');
      $(el).show();
      $("section &gt; div").not(el).hide();
    });
});
  
$(function() {
    $(".btn-hide").click(function(e) {
      e.preventDefault();
      el = $(this).data('element');
      $(el).hide();
    });
});</code></pre>
      <pre class="snippet-code-html lang-html prettyprint-override"><code>&lt;script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"&gt;&lt;/script&gt;
&lt;link href="https://cdn.datatables.net/1.11.4/css/dataTables.bootstrap5.min.css" rel="stylesheet"&gt;
&lt;link href="https://cdn.datatables.net/buttons/2.2.2/css/buttons.bootstrap5.min.css" rel="stylesheet"&gt;
&lt;script src="https://cdn.datatables.net/1.11.4/js/jquery.dataTables.min.js"&gt;&lt;/script&gt;
&lt;script src="https://cdn.datatables.net/1.11.4/js/dataTables.bootstrap5.min.js"&gt;&lt;/script&gt;
&lt;script src="https://cdn.datatables.net/buttons/2.2.2/js/dataTables.buttons.min.js"&gt;&lt;/script&gt;
&lt;script src="https://cdn.datatables.net/buttons/2.2.2/js/buttons.bootstrap5.min.js"&gt;&lt;/script&gt;
&lt;script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"&gt;&lt;/script&gt;
&lt;script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js"&gt;&lt;/script&gt;
&lt;script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js"&gt;&lt;/script&gt;
&lt;script src="https://cdn.datatables.net/buttons/2.2.2/js/buttons.html5.min.js"&gt;&lt;/script&gt;
&lt;script src="https://cdn.datatables.net/buttons/2.2.2/js/buttons.print.min.js"&gt;&lt;/script&gt;
&lt;script src="https://cdn.datatables.net/buttons/2.2.2/js/buttons.colVis.min.js"&gt;&lt;/script&gt;

&lt;a href="s103" data-element="#minhaDiv103" class="btn-show cons-assid"&gt;
    &lt;i class="metismenu-icon pe-7s-wristwatch"&gt;&lt;/i&gt;
    Assiduidade
&lt;/a&gt;
&lt;section id="s103"&gt;
  &lt;div style="display:none" id="minhaDiv103"&gt;
    &lt;table class="align-middle mb-0 table table-borderless table-striped table-hover consultassid" id="consultassid"&gt;
        &lt;thead&gt;
            &lt;tr&gt;
                &lt;th class="text-center" style="display:none;"&gt;Mes&lt;/th&gt;
                &lt;th class="text-center" style="display:none;"&gt;Dia&lt;/th&gt;
                &lt;th class="text-center"&gt;Colaborador&lt;/th&gt;
                &lt;th class="text-center"&gt;Serviço&lt;/th&gt;
                &lt;th class="text-center"&gt;Data&lt;/th&gt;
                &lt;th class="text-center"&gt;Entrada&lt;/th&gt;
                &lt;th class="text-center"&gt;Saída&lt;/th&gt;
                &lt;th class="text-center"&gt;Horas Diárias&lt;/th&gt;
                &lt;th class="text-center"&gt;Acumulado Mensal&lt;/th&gt;
            &lt;/tr&gt;
        &lt;/thead&gt;
        &lt;tbody&gt;

        &lt;/tbody&gt;
    &lt;/table&gt;
  &lt;/div&gt;
&lt;/section&gt;</code></pre>
     </div>
    </div>
    <p></p>
    <p>As I have the code, the first two columns are hidden, but when I print with datatables these two columns appear.</p>
    <p>I wanted these columns not to appear in the print automatically, without user action. In addition to these two, it also intended to hide the first two visible columns from printing, also automatically.</p>
    <p>Can you help?</p>
   </div>
   <div class="tags">
    <span class="tag">javascript</span><span class="tag">html</span><span class="tag">datatable</span>
   </div>
   <hr>
   <div class="comment">
    <table>
    </table>
   </div>
   <br>
   <div>
    <h2 id="answer_1"><span>Answer 1</span></h2>
    <div class="container-metadata">
     <div>
      <span>Score: </span> <span>1</span>
     </div>
     <div>
      <span>Answerer: </span> <span>andrewJames</span>
     </div>
     <div>
      <span> Answered: </span> <span>10 Aug 2022 at 19:14</span>
     </div>
    </div>
    <div>
     <p>You can use the <code>columns</code> option which is part of the Button's <a href="https://datatables.net/reference/api/buttons.exportData()" rel="nofollow noreferrer"><code>exportData()</code></a> function.</p>
     <p>There are various ways to use this, but one way is to add it as an <code>exportOptions</code> option for each button. For example:</p>
     <pre class="lang-js prettyprint-override"><code>buttons: [
  {
    extend: 'excel',
    text: 'excel',
    title: 'Registo de Marcações',
    exportOptions: {
      columns: &lt;columns-selector-goes-here&gt;
    }    
  },
...
]
</code></pre>
     <p>For the <a href="https://datatables.net/reference/type/column-selector" rel="nofollow noreferrer">columns selector</a>, there is a fairly wide range of different formats that you can provide.</p>
     <p>A simple one is an array containing each column index:</p>
     <pre><code>columns: [4,5,6,7,8]
</code></pre>
     <p>If you want to define the column selector as "everything except the first 4 columns" (indexes 0 through 3), you can use a function:</p>
     <pre class="lang-js prettyprint-override"><code>exportOptions: {
  columns: function ( idx, data, node ) {
    if (idx &gt;= 4) {
        return data;
    }
  }
}    
</code></pre>
     <p>You can also experiment with all the other formats accepted by the <a href="https://datatables.net/reference/type/column-selector" rel="nofollow noreferrer"><code>column-selector</code></a>.</p>
     <hr>
     <p>You need to add the <code>exportOptions</code> option to each different button - Excel, PDF, Print. But you can also simplify things slightly by defining the <code>column-selector</code> as a variable, instead of repeating it explicitly for each button.</p>
    </div>
    <hr>
    <div class="comment">
     <table>
     </table>
    </div>
   </div>
   <br>
   <div>
    <span>License: </span> <a href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a> <span>by </span> <a href="https://stackoverflow.com/legal/terms-of-service#licensing">Stack Overflow Inc.</a>
   </div>
  </div>
 </body>
</html>